<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>report</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about_us.html">About us</a>
</li>
<li>
  <a href="proposal.html">Proposal</a>
</li>
<li>
  <a href="report.html">Report</a>
</li>
<li>
  <a href="data.html">Data</a>
</li>
<li>
  <a href="eda.html">EDA</a>
</li>
<li>
  <a href="modelling.html">Modelling</a>
</li>
<li>
  <a href="discussion.html">Discussion</a>
</li>
<li>
  <a href="interactive_map.html">Interactive Map</a>
</li>
<li>
  <a href="https://youtu.be/2_Qcc_IW_dY">
    <span class="fa fa-play-circle fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/zihanemmaxiong/p8105_final_project_v2">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">report</h1>

</div>


<style>
body {
  color: #382320 !important;    
}

h1, h2, h3, h4, h5 {
  color: #382320 !important;     
}
</style>
<div class="body-overlay">

</div>
<div class="main-container">
<p><link href="https://fonts.googleapis.com/css2?family=Kranky&display=swap" rel="stylesheet"></p>
<style>
.rat-title {
  font-family: 'Kranky', cursive;
  font-size: 46px;
  font-weight: 400;
  color: #333333;
  letter-spacing: 1px;
  margin-top: 10px;
  margin-bottom: 14px;
}
</style>
<style>
body {
  background-image: url("images/proposal_bg.jpg");
  background-size: cover;
  background-attachment: fixed;
  background-position: center;
  background-repeat: no-repeat;
  opacity: 1;
}

.body-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 190%;    
  height: 120%;   
  background: rgba(255,255,255,0.05); 
  z-index: -1;    
  pointer-events: none;
}

.main-container {
  background: rgba(255,255,255,0.75);
  padding: 20px;
  border-radius: 12px;
}
</style>
<h1 class="rat-title">
Report
</h1>
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>New York City is well-known for its rodent challenges, and rat
sightings have continued to increase in recent years. At the same time,
restaurant sanitation is a key part of the city’s environmental health
system. We wanted to understand whether these two issues are connected:
Do poor restaurant conditions contribute to higher rat activity in
surrounding neighborhoods?</p>
<p>Because rats, food waste, and human activity all interact at the
neighborhood level, exploring this relationship can offer insights for
targeted public health and sanitation strategies.</p>
</div>
<div id="related-work" class="section level2">
<h2>Related Work</h2>
<p>Our project was inspired by several sources. NYC Open Data provides
large, publicly accessible datasets related to 311 rat complaints and
DOHMH restaurant inspections. Prior studies and news reports have
described seasonal patterns in rat sightings and highlighted sanitation
as a contributing factor, but few have merged these datasets to look at
neighborhood-level associations.</p>
<p>Spatial epidemiology tools, such as hotspot detection and
neighborhood clustering, also informed our approach, as this type of
analysis is commonly used to study environmental and health
disparities.</p>
</div>
<div id="initial-questions" class="section level2">
<h2>Initial Questions</h2>
<p>We began with three main questions:</p>
<ol style="list-style-type: decimal">
<li><p>Are rat sightings higher in neighborhoods with worse restaurant
sanitation?</p></li>
<li><p>Do rat sightings follow seasonal trends over time?</p></li>
<li><p>Are there clear spatial hotspots of rats and violations across
NYC?</p></li>
</ol>
<p>As we started cleaning and exploring the data, the project naturally
expanded. We realized that socioeconomic factors such as poverty and
population density showed strong patterns across neighborhoods, so we
added the question:</p>
<ol start="4" style="list-style-type: decimal">
<li>How do SES conditions shape both rat activity and violation
patterns?</li>
</ol>
<p>During modeling, we also saw evidence of possible reverse causality
(higher rat activity could lead to stricter inspections), so we
introduced a lagged exposure variable:</p>
<ol start="5" style="list-style-type: decimal">
<li>Does the previous month’s restaurant violation rate predict current
rat sightings?</li>
</ol>
<p>This became one of the key components of our final analysis.</p>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<pre class="r"><code>library(tidyverse)
library(readr)
library(janitor)
library(dplyr)
library(ggplot2)
library(readxl)
library(sf)
library(spdep)
library(tigris)
library(lubridate)</code></pre>
<p>We integrated and merged three datasets for our analysis: <strong>Rat
Sighting</strong>, <strong>NYC Restaurant Inspection Result</strong>,and
<strong>ACS 2019 5-year estimates</strong>. To ensure temporal
consistency and spatial alignment across datasets, the following steps
were applied.</p>
<p><em>Notice: For the merged data and its cleaning process, we didn’t
include <code>longitude</code> and <code>latitude</code> because they
are not able to be merged on zipcode x year x month level. We left them
for Spatial Analysis specifically. For <strong>all</strong> 3 datasets,
only records with ZIP codes 10001–11697 were included (notice that NYC
zip codes are not cumulative so only zipcodes in this range+overlaps
between 3 datasets). For <strong>Rat Sighting</strong> and <strong>NYC
Restaurant Inspection Result</strong> datasets, records with dates
between 2019-01-01 and 2024-12-31 were included.</em></p>
<pre class="r"><code>rats_clean_2019_2024 &lt;- read_csv(
  &quot;data/Rat_Sightings_20251106.csv&quot;,
  na = c(&quot;NA&quot;, &quot;&quot;, &quot;0&quot;)
) |&gt;
  janitor::clean_names() |&gt;
  # covert datetime to example: &quot;2024-12-31 18:15:58&quot;
  mutate(
    created_datetime = lubridate::parse_date_time(
      created_date,
      orders = &quot;Y b d I:M:S p&quot;,
      tz = &quot;America/New_York&quot;
    ),
    created_date_only = as.Date(created_datetime)
  ) |&gt;
  # filter: 2019–2024 and zipcodes 10001-11697
  filter(
    !is.na(created_datetime),
    created_date_only &gt;= as.Date(&quot;2019-01-01&quot;),
    created_date_only &lt;= as.Date(&quot;2024-12-31&quot;)
  ) |&gt;
  mutate(
    incident_zip = incident_zip |&gt;
      as.character() |&gt;
      stringr::str_extract(&quot;\\d+&quot;) |&gt;
      stringr::str_pad(width = 5, side = &quot;left&quot;, pad = &quot;0&quot;)
  ) |&gt;
  filter(
    incident_zip &gt;= &quot;10001&quot;,
    incident_zip &lt;= &quot;11697&quot;
  ) |&gt;
  dplyr::select(
    dplyr::any_of(c(
      &quot;unique_key&quot;, 
      &quot;created_date_only&quot;,
      &quot;complaint_type&quot;, 
      &quot;descriptor&quot;, 
      &quot;status&quot;, 
      &quot;resolution_action_updated_date&quot;, 
      &quot;location_type&quot;, 
      &quot;incident_zip&quot;,
      &quot;incident_address&quot;, 
      &quot;street_name&quot;, 
      &quot;cross_street_1&quot;, 
      &quot;cross_street_2&quot;, 
      &quot;city&quot;, 
      &quot;borough&quot;,
      &quot;latitude&quot;,
      &quot;longitude&quot;,
      &quot;community_board&quot;, 
      &quot;council_district&quot;, 
      &quot;census_tract&quot;, 
      &quot;nta&quot; 
    ))
  ) |&gt;
  # keep for spatial analysis
  filter(
    !is.na(incident_zip),
    !is.na(latitude),
    !is.na(longitude)
  ) |&gt;
  # standardize zipcode, year, and month
  mutate(
    zipcode = incident_zip,
    year    = lubridate::year(created_date_only),
    month   = lubridate::month(created_date_only)
  )</code></pre>
</div>
<div id="data-source-1" class="section level2">
<h2>Data Source 1</h2>
<p><strong><a
href="https://data.cityofnewyork.us/Social-Services/Rat-Sightings/3q43-55fe/about_data">Rat
Sighting</a></strong>: Each row represents one rat sighting report based
on the <a
href="https://data.cityofnewyork.us/Social-Services/311-Service-Requests-from-2010-to-Present/erm2-nwe9/about_data">311
Service Requests</a>. Key raw fields include complaint date, exact
address, borough, zipcodes, and geographic coordinates.</p>
<p><strong>Data Pre-cleaning steps included:</strong></p>
<ul>
<li><p>Converted raw timestamps <code>created_date_only</code> into
standardized datetime (yyyy-mm-dd), then create new variables
<code>year</code> and <code>month</code>.</p></li>
<li><p>Extracted valid 5-digit NYC ZIP codes (10001–11697)
<code>incident_zip</code>, then create new variable
<code>zipcode</code>.</p></li>
<li><p>Filtered to observations from 2019-01-01 to 2024-12-31.</p></li>
<li><p>Removed records missing ZIP or geolocation (required for spatial
EDA), and keep variables <code>longitude</code> and
<code>latitude</code> for future <strong>Spatial
Analysis</strong>.</p></li>
<li><p>We were not interested in all variables of the raw dataset, so we
selected for merged data:</p></li>
</ul>
<p><code>unique_key</code>: unique ID represents a single rat sighting
report.</p>
<p><code>created_date_only</code>: date of the complaint created without
exact time.</p>
<p><code>zipcode</code>: zip codes of the rat sighting complaints.</p>
<p><code>year</code>: year of the rat sighting complaints.</p>
<p><code>month</code>: month of the rat sighting complaints.</p>
<p><code>latitude</code>: the latitude of the specific rat sighting.</p>
<p><code>longitude</code>: the longitude of the specific rat
sighting.</p>
<pre class="r"><code>rat_agg_zip_month_full &lt;- rats_clean_2019_2024 |&gt;
  group_by(zipcode, year, month) |&gt;
  summarize(
    rat_count_zip_month = n_distinct(unique_key),
    .groups = &quot;drop&quot;
  ) |&gt;
  complete(
    zipcode,
    year,
    month,
    fill = list(rat_count_zip_month = 0)
  )</code></pre>
<p><strong>Aggregate Rat Sighting by zip x year x month</strong>, then
create a new variable <code>rat_count_zip_month</code>: total numbers of
rat sightings count of a specific zip by year by month.</p>
<pre class="r"><code>inspections_clean &lt;- read_csv(
  &quot;data/DOHMH_New_York_City_Restaurant_Inspection_Results.csv&quot;,
  na = c(&quot;NA&quot;, &quot;&quot;, &quot;0&quot;)
) |&gt;
  clean_names() |&gt;
  remove_empty(c(&quot;rows&quot;, &quot;cols&quot;)) |&gt;
  
  # Standardize ZIP and Dates
  mutate(
    zipcode = zipcode |&gt;
      as.character() |&gt;
      str_extract(&quot;\\d{5}&quot;) |&gt;   # ensure 5-digit format
      str_pad(width = 5, pad = &quot;0&quot;),
    date = mdy(inspection_date)
  ) |&gt;
  
  # Filter valid records
  filter(
    !is.na(date),
    date &gt;= as.Date(&quot;2019-01-01&quot;),
    date &lt;= as.Date(&quot;2024-12-31&quot;),

    !is.na(zipcode),
    zipcode &gt;= &quot;10001&quot;,
    zipcode &lt;= &quot;11697&quot;,

    !is.na(latitude),
    !is.na(longitude),
    !is.na(boro),
    !is.na(violation_code)   # keep only violation records
  ) |&gt;
  
  # Select necessary variables
  dplyr::select(
    restaurant_id = camis,
    dba,
    borough = boro,
    zipcode,
    cuisine_description,
    date,
    action,
    violation_code, violation_description, critical_flag,
    score, grade, grade_date, record_date,
    inspection_type,
    latitude, longitude
  ) |&gt;
  
  # Add Year and Month
  mutate(
    year = year(date),
    month = month(date)
  )</code></pre>
</div>
<div id="data-source-2" class="section level2">
<h2>Data Source 2</h2>
<p><strong><a
href="https://data.cityofnewyork.us/Health/DOHMH-New-York-City-Restaurant-Inspection-Results/43nn-pn8j/about_data">NYC
Restaurant Inspection Result</a></strong>: We utilized the NYC
Restaurant Inspection Results dataset obtained from NYC Open Data, which
compiles sanitation inspection outcomes for food service establishments
across New York City. The dataset contains restaurant-level violation
records including location, inspection dates, cuisine type, violation
codes, and inspection results issued by the Department of Health and
Mental Hygiene (DOHMH). This dataset provides an indicator of
environmental hygiene conditions that may influence rodent activity.</p>
<p><strong>Data Pre-cleaning steps included:</strong> - Extracted valid
5-digit NYC ZIP codes (10001–11697) <code>zipcode</code> and padded to
valid 5-digit format.</p>
<p>-Raw inspection dates <code>inspection_date</code> converted to
standardized Date format. Extracted <code>year</code> and
<code>month</code> for temporal trend analysis.</p>
<ul>
<li><p>Retained only observations with non-missing
<code>violation_code</code>. Inspections showing “No violations
observed” were excluded. Removed incomplete geographic records lacking
<code>latitude</code>/<code>longitude</code> or borough values.</p></li>
<li><p>We were not interested in all variables of the raw dataset, so we
selected for merged data:</p></li>
</ul>
<p><code>restaurant_id</code>: unique ID of each restaurants.</p>
<p><code>zipcode</code>: zip codes of restaurants.</p>
<p><code>year</code>: year of the Restaurant Inspection and Violations
Results.</p>
<p><code>month</code>: month of the Restaurant Inspection and Violations
Results.</p>
<p><code>latitude</code>: the latitude of the Restaurants.</p>
<p><code>longitude</code>: the longitude of the Restaurants.</p>
<pre class="r"><code>restaurant_agg_zip_month_full &lt;- inspections_clean |&gt;
  group_by(zipcode, year, month) |&gt;
  summarise(
    violation_count_zip_month = n(),
    inspection_count_zip_month = n_distinct(restaurant_id, date),
    .groups = &quot;drop&quot;
  ) |&gt;
 complete(
    zipcode,
    year  = 2019:2024,
    month = 1:12,
    fill = list(
      violation_count_zip_month   = 0,
      inspection_count_zip_month = 0
    )
  )</code></pre>
<p><strong>Aggregate NYC Restaurant Inspection Results by zip x year x
month</strong>, then create new variables:
<code>violation_count_zip_month</code> (total number of recorded
violations within each ZIP–year–month) and
<code>inspection_count_zip_month</code>(total number of recorded
inspections within each ZIP–year–month).</p>
<pre class="r"><code>library(tidycensus)
library(tidyverse)

acs_zip_raw &lt;- get_acs(
  geography = &quot;zip code tabulation area&quot;,
  variables = c(
    total_pop   = &quot;B01003_001&quot;,
    pov_total   = &quot;B17001_001&quot;,
    pov_count   = &quot;B17001_002&quot;,
    med_income  = &quot;B19013_001&quot;
  ),
  year   = 2019,
  survey = &quot;acs5&quot;,
  geometry = FALSE
)

ses_zip &lt;- acs_zip_raw %&gt;%
  select(GEOID, variable, estimate) %&gt;%
  pivot_wider(
    names_from  = variable,
    values_from = estimate
  ) %&gt;%
  mutate(
    zip = GEOID,
    poverty_rate = pov_count / pov_total,
    population_density = total_pop / 1000,
    median_household_income = med_income / 1000
  )

ses_zip_nyc &lt;- ses_zip %&gt;%
  mutate(zip_num = as.numeric(zip)) %&gt;%
  filter(
    !is.na(zip_num),
    zip_num &gt;= 10001,
    zip_num &lt;= 11697,
    total_pop &gt; 0,
    pov_total &gt; 0
  ) %&gt;%
  select(
    zipcode  = zip_num,
    total_pop,
    poverty_rate,
    population_density,
    median_household_income
  )</code></pre>
</div>
<div id="data-source-3" class="section level2">
<h2>Data Source 3</h2>
<p><strong>ACS 2019 5-year estimates</strong>: Area-level socioeconomic
indicators were obtained from the 2015–2019 ACS 5-year estimates at the
ZIP Code Tabulation Area (ZCTA) level using <em>tidycensus</em> in R.
*Notice: We selected the 2015–2019 estimates because the 2019–2023 ACS
data were affected by COVID-19-related disruptions and contained
substantial missingness, while SES indicators remain relatively stable
over time.</p>
<p><strong>Data Pre-cleaning and preparation</strong>:</p>
<ul>
<li><p>Extracted valid 5-digit NYC ZIP codes (10001–11697)
<code>zipcode</code> and padded to valid 5-digit format.</p></li>
<li><p>We focused on variables that are most relevant to restaurant
sanitation and the environmental conditions influencing rat
activity:</p></li>
</ul>
<p><code>zipcode</code>: zipcodes of the NYC.</p>
<p><code>total_pop</code>: total population of the specific zipcode.</p>
<p><code>pov_count</code>: the subset of individuals living below the
U.S. federal poverty threshold as defined by the ACS</p>
<p><code>pov_total</code>: the total civilian population within the ZIP
Code Tabulation Area eligible for poverty status determination</p>
<p><code>med_income</code>:the midpoint of the household income
distribution where 50% of households earn more and 50% earn less</p>
<p>We also realized that counts describe size and may cause bias (For
example, high rodent risk may still exist in smaller-population
neighborhoods, and count-based socioeconomic metrics would underestimate
such disparities.), but rates and densities describe risk and
environment — which are what we want to study. Hence, we created new zip
-level variables:</p>
<p><span class="math inline">\(pov\_rate =
\frac{pov\_count}{pov\_total}\)</span>: represents the proportion of
residents living below the federal poverty threshold within each ZIP
Code Tabulation Area</p>
<p><span class="math inline">\(population\_density =
\frac{total\_pop}{1000}\)</span>: expresses the concentration of
residents per ZIP code, measured as total population per 1,000
residents, serving as an indicator of urbanization and built environment
crowding.</p>
<p><span class="math inline">\(median\_household\_income =
\frac{med\_income}{1000}\)</span>: reflects the neighborhood’s economic
resource level. med_income denotes the ACS-estimated median household
income in USD, scaled per $1,000 for interpretability in modeling and
descriptive statistics.</p>
<pre class="r"><code>rat_fixed &lt;- rat_agg_zip_month_full |&gt;
  mutate(zipcode = as.character(zipcode))

restaurant_fixed &lt;- restaurant_agg_zip_month_full |&gt;
  mutate(zipcode = as.character(zipcode))

ses_fixed &lt;- ses_zip_nyc |&gt;
  mutate(zipcode = as.character(zipcode))

common_zips &lt;- Reduce(
  intersect,
  list(
    rat_fixed$zipcode,
    restaurant_fixed$zipcode,
    ses_fixed$zipcode
  )
)

rat_filtered &lt;- rat_fixed |&gt;
  filter(zipcode %in% common_zips)

restaurant_filtered &lt;- restaurant_fixed |&gt;
  filter(zipcode %in% common_zips)

ses_filtered &lt;- ses_fixed |&gt;
  filter(zipcode %in% common_zips)

df_merged &lt;- rat_filtered |&gt;
  inner_join(restaurant_filtered,
             by = c(&quot;zipcode&quot;, &quot;year&quot;, &quot;month&quot;)) |&gt;
  inner_join(ses_filtered,
             by = &quot;zipcode&quot;)

write_csv(df_merged, &quot;./data/zip_year_month_merged.csv&quot;)</code></pre>
</div>
<div id="merge-3-datasets-by-zipcode-x-year-x-month"
class="section level2">
<h2>Merge 3 datasets by zipcode x year x month</h2>
<p>In the merged dataset, we included variables: <code>zipcode</code>,
<code>year</code>, <code>month</code>, <code>rat_count_zip_month</code>,
<code>violation_count_zip_month</code>,
<code>inspection_count_zip_month</code>, <code>total_pop</code>,
<code>poverty_rate</code>, <code>population_density</code>.</p>
</div>
<div id="export" class="section level2">
<h2>Export</h2>
<p>We exported the merged dataset as csv file zip_year_month_merged.</p>
<hr />
<pre class="r"><code>knitr::opts_chunk$set(
    echo = TRUE,
    warning = FALSE,
  fig.width = 6,
  fig.asp = .6,
  out.width = &quot;90%&quot;
)

theme_set(theme_minimal() + theme(legend.position = &quot;bottom&quot;))

options(
  ggplot2.continuous.colour = &quot;viridis&quot;,
  ggplot2.continuous.fill = &quot;viridis&quot;
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d</code></pre>
</div>
<div id="spatial-patterns-seeing-where-rats-live"
class="section level1">
<h1>Spatial Patterns: Seeing Where Rats Live</h1>
<p>Before doing any modelling, we want to know whether ZIP codes are a
reasonable spatial unit of analysis. Do rat sightings show coherent
spatial patterns at the ZIP level, with recognizable “hot” and “cold”
areas? Also for restaurants, do health violations show a similar,
spatially structured pattern across ZIP codes, and are the “risky” food
environments in the same areas where rat activity is high?</p>
<pre class="r"><code>df_merged &lt;- readr::read_csv(&quot;data/zip_year_month_merged.csv&quot;) |&gt;
  janitor::clean_names() |&gt;
  dplyr::mutate(zipcode = as.character(zipcode))</code></pre>
<pre class="r"><code>zip_df &lt;- df_merged |&gt;
  group_by(zipcode) |&gt;
  summarise(
    rat_count_total = sum(rat_count_zip_month, na.rm = TRUE),
    violation_total = sum(violation_count_zip_month, na.rm = TRUE),
    inspection_total = sum(inspection_count_zip_month, na.rm = TRUE),
    total_pop = mean(total_pop, na.rm = TRUE)
  ) |&gt;
  mutate(
    rats_per_10000 = 10000 * rat_count_total / total_pop,
    violations_per_restaurant = violation_total / inspection_total
  ) |&gt;
  filter(
    !is.na(rats_per_10000),
    !is.na(violations_per_restaurant)
  )</code></pre>
<pre class="r"><code>ny_zcta &lt;- tigris::zctas(state = &quot;NY&quot;, year = 2010) |&gt;
  dplyr::rename(zipcode = ZCTA5CE10) |&gt;
  dplyr::mutate(zipcode = as.character(zipcode))  

ny_zip_sf &lt;- ny_zcta |&gt;
  dplyr::left_join(zip_df, by = &quot;zipcode&quot;) |&gt;
  dplyr::filter(!is.na(violations_per_restaurant)) |&gt;
  sf::st_transform(2263)  </code></pre>
<div id="rat-sightings-per-10000-residents" class="section level3">
<h3>Rat Sightings per 10,000 Residents</h3>
<p>The map shows strong spatial variation in rat sightings per 10,000
residents. Staten Island and much of far-eastern Queens appear as clear
“cold spots” with relatively few rat complaints. In contrast, several
ZIP codes in central and northern Brooklyn and parts of the Bronx stand
out as “hot spots” with very high rat sighting rates. Manhattan shows a
mixed picture: midtown and some dense residential areas have elevated
rates, while a few upper-Manhattan ZIP codes are more moderate. These
gradients suggest that ZIP-level variation is not random noise:
neighboring ZIPs often share similar levels, and large, contiguous
high-burden and low-burden areas are visible. This supports using ZIP
code as the unit of analysis for subsequent spatial and spatio-temporal
work.</p>
<pre class="r"><code>ggplot(ny_zip_sf, aes(fill = rats_per_10000)) +
  geom_sf(color = &quot;white&quot;, size = 0.1) +
  scale_fill_viridis_c(option = &quot;C&quot;) +
  labs(
    title = &quot;Rat Sightings per 10,000 Residents (2019–2024)&quot;,
    fill  = &quot;Rats / 10,000&quot;
  ) +
  theme_minimal()</code></pre>
<p><img src="report_files/figure-html/map-rats-1.png" width="90%" /></p>
</div>
<div id="violations-per-restaurant" class="section level3">
<h3>Violations per Restaurant</h3>
<p>Violations per restaurant also vary systematically by location.
Staten Island and some lower-density parts of Brooklyn and Queens tend
to have lower violation rates, while several ZIP codes in northern
Brooklyn, western Queens, and portions of Manhattan display higher
average violations per restaurant. The pattern is not identical to rat
activity: some areas with high violation rates do not have the highest
rat complaint rates, and vice versa.</p>
<pre class="r"><code>ggplot(ny_zip_sf, aes(fill = violations_per_restaurant)) +
  geom_sf(color = &quot;white&quot;, size = 0.1) +
  scale_fill_viridis_c(option = &quot;C&quot;) +
  labs(
    title = &quot;Violations per Restaurant (2019–2024)&quot;,
    fill  = &quot;Violations / Inspection&quot;
  ) +
  theme_minimal()</code></pre>
<p><img src="report_files/figure-html/map-viol-1.png" width="90%" /></p>
<p>Overall, both outcomes show meaningful spatial structure at the ZIP
level, confirming that ZIP codes are a workable unit for analyzing
neighborhood-level food environment and rodent burden.</p>
</div>
<div id="are-hotspots-really-clustering" class="section level2">
<h2>Are Hotspots Really Clustering?</h2>
<p>In the Local Moran’s I maps, each ZIP code is classified into one of
four cluster types based on its own value and the average of its
neighbors:</p>
<ul>
<li><p><strong>High–High:</strong> ZIP codes with high values surrounded
by neighbors that also have high values.</p></li>
<li><p><strong>Low–Low:</strong> ZIP codes with low values surrounded by
low-value neighbors.</p></li>
<li><p><strong>High–Low:</strong> ZIP codes with high values surrounded
by low-value neighbors. These are potential spatial outliers that stand
out from a low-value area.</p></li>
<li><p><strong>Low–High:</strong> ZIP codes with low values surrounded
by high-value neighbors. These are the opposite type of spatial
outlier.</p></li>
</ul>
<pre class="r"><code>nb &lt;- spdep::poly2nb(ny_zip_sf)
lw &lt;- spdep::nb2listw(nb, style = &quot;W&quot;, zero.policy = TRUE)</code></pre>
<div id="local-morans-i-clusters-for-rat-sightings-per-10000-residents"
class="section level3">
<h3>Local Moran’s I Clusters for Rat Sightings per 10,000 Residents</h3>
<pre class="r"><code>rats_lisa &lt;- spdep::localmoran(
  ny_zip_sf$rats_per_10000,
  lw,
  zero.policy = TRUE
)

rats_lisa_df &lt;- as.data.frame(rats_lisa)

ny_zip_sf &lt;- ny_zip_sf |&gt;
  dplyr::mutate(
    rats_I    = rats_lisa_df$Ii,          # 第 1 列
    rats_p    = rats_lisa_df[[ncol(rats_lisa_df)]],  # 最后一列，通常是 p-value
    rats_mean = mean(rats_per_10000, na.rm = TRUE),
    rats_centered = rats_per_10000 - rats_mean,
    rats_lag  = spdep::lag.listw(lw, rats_per_10000, zero.policy = TRUE),

    rats_quad = dplyr::case_when(
      rats_centered &gt; 0 &amp; rats_lag &gt; 0 &amp; rats_p &lt;= 0.05 ~ &quot;High-High&quot;,
      rats_centered &lt; 0 &amp; rats_lag &lt; 0 &amp; rats_p &lt;= 0.05 ~ &quot;Low-Low&quot;,
      rats_centered &gt; 0 &amp; rats_lag &lt; 0 &amp; rats_p &lt;= 0.05 ~ &quot;High-Low&quot;,
      rats_centered &lt; 0 &amp; rats_lag &gt; 0 &amp; rats_p &lt;= 0.05 ~ &quot;Low-High&quot;,
      TRUE ~ &quot;Not significant&quot;
    )
  )</code></pre>
<p>For rat sightings, High–High clusters appear in several contiguous
ZIP codes in central Brooklyn and parts of the Bronx, indicating true
neighborhood-level hotspots rather than single noisy ZIP codes. Low–Low
clusters are concentrated in Staten Island and some peripheral ZIPs in
Queens, reinforcing the idea of structurally lower rat burden in those
areas. A few High–Low or Low–High ZIPs sit on the edges of these
clusters, suggesting transition zones where rat activity is changing or
where local conditions differ from the broader neighborhood context.</p>
<pre class="r"><code>cluster_cols &lt;- c(
  &quot;High-High&quot;       = &quot;#b2182b&quot;,
  &quot;Low-Low&quot;         = &quot;#2166ac&quot;,
  &quot;High-Low&quot;        = &quot;#ef8a62&quot;,
  &quot;Low-High&quot;        = &quot;#67a9cf&quot;,
  &quot;Not significant&quot; = &quot;grey90&quot;
)

ggplot2::ggplot(ny_zip_sf, ggplot2::aes(fill = rats_quad)) +
  ggplot2::geom_sf(color = &quot;white&quot;, size = 0.1) +
  ggplot2::scale_fill_manual(values = cluster_cols) +
  ggplot2::labs(
    title = &quot;Local Moran&#39;s I Clusters for Rat Sightings per 10,000 Residents&quot;,
    fill  = &quot;Cluster&quot;
  ) +
  ggplot2::theme_minimal()</code></pre>
<p><img src="report_files/figure-html/map-lisa-rats-1.png" width="90%" /></p>
</div>
<div id="local-morans-i-clusters-for-violations-per-restaurant"
class="section level3">
<h3>Local Moran’s I Clusters for Violations per Restaurant</h3>
<pre class="r"><code>viol_lisa &lt;- spdep::localmoran(
  ny_zip_sf$violations_per_restaurant,
  lw,
  zero.policy = TRUE
)

viol_lisa_df &lt;- as.data.frame(viol_lisa)

ny_zip_sf &lt;- ny_zip_sf |&gt;
  dplyr::mutate(
    viol_I   = viol_lisa_df$Ii,
    viol_p   = viol_lisa_df[[ncol(viol_lisa_df)]],
    viol_mean = mean(violations_per_restaurant, na.rm = TRUE),
    viol_centered = violations_per_restaurant - viol_mean,
    viol_lag = spdep::lag.listw(lw, violations_per_restaurant, zero.policy = TRUE),

    viol_quad = dplyr::case_when(
      viol_centered &gt; 0 &amp; viol_lag &gt; 0 &amp; viol_p &lt;= 0.05 ~ &quot;High-High&quot;,
      viol_centered &lt; 0 &amp; viol_lag &lt; 0 &amp; viol_p &lt;= 0.05 ~ &quot;Low-Low&quot;,
      viol_centered &gt; 0 &amp; viol_lag &lt; 0 &amp; viol_p &lt;= 0.05 ~ &quot;High-Low&quot;,
      viol_centered &lt; 0 &amp; viol_lag &gt; 0 &amp; viol_p &lt;= 0.05 ~ &quot;Low-High&quot;,
      TRUE ~ &quot;Not significant&quot;
    )
  )</code></pre>
<p>For violations per restaurant, High–High clusters appear in several
ZIP codes in parts of northern Brooklyn and western Queens, as well as a
few ZIPs in Manhattan. These areas represent dense restaurant corridors
where many establishments have above-average violation rates and are
surrounded by similarly high-violation neighbors. Low–Low clusters are
again found in much of Staten Island and some lower-density fringe ZIPs,
where restaurants tend to have fewer violations and neighboring areas
share this profile.</p>
<p>The overlap between rat High–High clusters and violation High–High
clusters is partial but not complete. This suggests that while poor
restaurant conditions may contribute to rodent problems, rat burden is
also shaped by other factors such as housing quality, building age,
waste management, and overall neighborhood density.</p>
<pre class="r"><code>cluster_cols &lt;- c(
  &quot;High-High&quot;       = &quot;#b2182b&quot;,
  &quot;Low-Low&quot;         = &quot;#2166ac&quot;,
  &quot;High-Low&quot;        = &quot;#ef8a62&quot;,
  &quot;Low-High&quot;        = &quot;#67a9cf&quot;,
  &quot;Not significant&quot; = &quot;grey90&quot;
)

ggplot2::ggplot(ny_zip_sf, ggplot2::aes(fill = viol_quad)) +
  ggplot2::geom_sf(color = &quot;white&quot;, size = 0.1) +
  ggplot2::scale_fill_manual(values = cluster_cols) +
  ggplot2::labs(
    title = &quot;Local Moran&#39;s I Clusters for Violations per Restaurant&quot;,
    fill  = &quot;Cluster&quot;
  ) +
  ggplot2::theme_minimal()</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-11-1.png" width="90%" /></p>
</div>
</div>
<div id="bivariate-hotspots-for-rats-sighting-and-violations"
class="section level2">
<h2>Bivariate Hotspots for Rats Sighting and Violations</h2>
<div id="rat-sightings-per-10000-violations-per-restaurant"
class="section level3">
<h3>Rat Sightings per 10,000 × Violations per Restaurant</h3>
<ul>
<li><p><strong>Double-burden areas</strong> (high rats, high
violations): Several central and northern Brooklyn ZIPs and parts of the
Bronx fall into the highest category for both measures. These are
neighborhoods where residents are simultaneously exposed to poor
restaurant hygiene and high rodent activity. The color gradient suggests
these hotspots are not isolated; similar colors extend into adjacent
ZIPs, indicating a spatial diffusion pattern rather than a single
problematic block.</p></li>
<li><p><strong>Low-burden areas</strong> (low rats, low violations):
Much of Staten Island and portions of eastern Queens cluster in the
bottom-left part of the bivariate legend. These areas likely have lower
population and restaurant density, more single-family housing, and
possibly better waste management, all of which can reduce both
violations and rat sightings.</p></li>
<li><p><strong>High rats, relatively low violations</strong> (rat-high /
restaurant-low): Some ZIPs near double-burden hotspots show high rat
sightings but only moderate or low restaurant violations. One plausible
explanation is that these neighborhoods may have fewer restaurants but
are adjacent to high-density commercial areas; rats can travel from
nearby hotspots via connected sewers, alleys, and transit corridors,
even if local restaurants are not the main driver.</p></li>
<li><p><strong>High violations, relatively low rats</strong>
(restaurant-high / rat-low): In contrast, a few ZIPs with many
restaurants and elevated violation rates do not yet show the highest rat
complaint rates. These may be emerging risk areas where poor restaurant
hygiene has not yet translated into widespread community rat complaints,
or where other environmental conditions (e.g., newer building stock,
less underground infrastructure, more aggressive pest control) are
temporarily buffering rat populations.</p></li>
</ul>
<pre class="r"><code>ny_zip_sf &lt;- ny_zip_sf |&gt;
  dplyr::mutate(
    viol_tertile = dplyr::ntile(violations_per_restaurant, 3),
    rats_tertile = dplyr::ntile(rats_per_10000, 3),
    bi_code = dplyr::if_else(
      is.na(viol_tertile) | is.na(rats_tertile),
      NA_character_,
      paste0(&quot;V&quot;, viol_tertile, &quot;R&quot;, rats_tertile)
    ),
    bi_numeric = dplyr::if_else(
      is.na(viol_tertile) | is.na(rats_tertile),
      NA_integer_,
      (viol_tertile - 1) * 3 + rats_tertile
    )
  )

bi_cols &lt;- viridis::cividis(9)
names(bi_cols) &lt;- as.character(1:9)

p_map &lt;- ggplot2::ggplot(ny_zip_sf, ggplot2::aes(fill = factor(bi_numeric))) +
  ggplot2::geom_sf(color = &quot;white&quot;, size = 0.1) +
  ggplot2::scale_fill_manual(
    values = bi_cols,
    na.value = &quot;grey90&quot;,
    guide = &quot;none&quot;
  ) +
  ggplot2::labs(
    title = &quot;Bivariate Map: Rat Sightings per 10,000 × Violations per Restaurant&quot;
  ) +
  ggplot2::theme_minimal()

legend_df &lt;- tidyr::expand_grid(
  viol_tertile = 1:3,
  rats_tertile = 1:3
) |&gt;
  dplyr::mutate(
    bi_numeric = (viol_tertile - 1) * 3 + rats_tertile,
    x = viol_tertile,
    y = rats_tertile
  )

p_legend &lt;- ggplot2::ggplot(legend_df, ggplot2::aes(x, y, fill = factor(bi_numeric))) +
  ggplot2::geom_tile(color = &quot;white&quot;) +
  ggplot2::scale_fill_manual(values = bi_cols, guide = &quot;none&quot;) +
  ggplot2::scale_x_continuous(
    breaks = c(1, 3),
    labels = c(&quot;Low&quot;, &quot;High&quot;),
    expand = c(0, 0)
  ) +
  ggplot2::scale_y_continuous(
    breaks = c(1, 3),
    labels = c(&quot;Low&quot;, &quot;High&quot;),
    expand = c(0, 0)
  ) +
  ggplot2::labs(
    x = &quot;Violations per Restaurant&quot;,
    y = &quot;Rat Sightings per 10,000&quot;
  ) +
  ggplot2::coord_equal() +
  ggplot2::theme_minimal(base_size = 9)

(p_map | p_legend) +
  patchwork::plot_layout(widths = c(4, 0.8))</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-12-1.png" width="90%" /></p>
</div>
</div>
</div>
<div id="rat-sighting-temporal-exploration" class="section level1">
<h1>Rat Sighting Temporal Exploration</h1>
<p>Next, we aim to examine whether there are temporal trends in rat
sighting. Specifically, we explore potential seasonal patterns as well
as differences across months and years. For this analysis, we use the
cleaned merged dataset at the ZIP code × year × month level.</p>
<pre class="r"><code>rat=read_csv(&quot;./data/zip_year_month_merged.csv&quot;)|&gt;
  mutate(month=as.integer(month)) |&gt;
  group_by(year, month) |&gt;
  summarise(rat_count_month = sum(rat_count_zip_month, na.rm = TRUE),.groups = &quot;drop&quot;) |&gt;
  arrange(year, month) |&gt;
  mutate(
    month_label=month.abb[month],
    month_label=factor(month_label, levels = month.abb)
  ) </code></pre>
<div id="monthly-rat-sightings-in-nyc-20192024" class="section level3">
<h3>Monthly Rat Sightings in NYC (2019–2024)</h3>
<p><strong>First</strong>, we examined the monthly total number of rat
sightings from 2019 to 2024. The line plot clearly reveals a
<strong>distinct seasonal pattern</strong>: rat sightings typically rise
from spring into late summer (May–September), peak around July–August,
and drop sharply during winter months. This pattern is likely driven by
seasonal environmental factors such as temperature, food availability,
and increased outdoor human activity (reference1).</p>
<p><strong>Second</strong>, there are noticeable <strong>year-to-year
differences</strong>, particularly around the COVID-19 pandemic period.
Counts in 2020 are substantially lower, which may reflect reduced human
activity during lockdown (e.g., fewer restaurant operations, less
outdoor waste, and lower reporting frequency). However, beginning in
2021, sightings rebounded quickly and reached the highest peak in summer
2022 (approximately 3000 reports). This suggests a potential increasing
long-term trend in rat activity, possibly related to environmental
changes or differences in municipal control strategies.</p>
<pre class="r"><code>plot_ly(
  rat,
  x = ~month_label,
  y = ~rat_count_month,
  color = ~factor(year),
  type = &#39;scatter&#39;,
  mode = &#39;lines+markers&#39;
  ) |&gt;
  layout(
    xaxis = list(title = &quot;Month&quot;),
    yaxis = list(title = &quot;Rat Sightings Count&quot;)
  )</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-0fb423454684d647f6fc" style="width:90%;height:345.6px;"></div>
<script type="application/json" data-for="htmlwidget-0fb423454684d647f6fc">{"x":{"visdat":{"13127613056a3":["function () ","plotlyVisDat"]},"cur_data":"13127613056a3","attrs":{"13127613056a3":{"x":{},"y":{},"mode":"lines+markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Month","type":"category","categoryorder":"array","categoryarray":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Rat Sightings Count"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[1003,946,1118,1463,1743,1713,1790,1837,1585,1381,952,779],"mode":"lines+markers","type":"scatter","name":"2019","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[1034,1007,950,939,1628,1617,1755,1787,1644,1532,1097,960],"mode":"lines+markers","type":"scatter","name":"2020","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[1235,951,1789,2066,2261,2591,2609,2471,2263,2655,1948,1728],"mode":"lines+markers","type":"scatter","name":"2021","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[1563,1529,2124,2111,2713,2969,2922,2842,2395,1954,1591,1337],"mode":"lines+markers","type":"scatter","name":"2022","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[1918,1679,1884,2211,2326,2348,2673,2841,2365,1946,1534,1404],"mode":"lines+markers","type":"scatter","name":"2023","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"line":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[1710,1707,1824,2071,2666,2462,2689,2597,2404,2086,1522,1088],"mode":"lines+markers","type":"scatter","name":"2024","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"line":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="distribution-of-monthly-rat-sightings-per-zip"
class="section level3">
<h3>Distribution of Monthly Rat Sightings per ZIP</h3>
<p>At the same time, we considered another important question: What does
the distribution of NYC ZIP–Month rat sightings look like? Are there
substantial differences across geographic areas? How many ZIP–Month
observations report zero or very low counts, and how many approach the
higher end of the range?</p>
<p>The histogram of ZIP–Month rat sightings shows that <strong>most
ZIP–Month combinations have very low rat counts</strong>, with only a
small proportion exhibiting high values. This results in a
<strong>highly right-skewed distribution</strong>, indicating that rat
activity is spatially <strong>concentrated</strong> and that a handful
of ZIP areas represent outliers with disproportionately high
sightings.</p>
<pre class="r"><code>plot_ly(
  rat1,
    x = ~rat_count_zip_month,
    type = &quot;histogram&quot;,
    nbinsx = 60,  
    marker = list(color = &#39;rgba(55, 55, 55, 0.8)&#39;)
  ) |&gt;
  layout(
    xaxis = list(title = &quot;Rat Sightings (ZIP-Month)&quot;),
    yaxis = list(title = &quot;Number of ZIP-Month Observations&quot;),
    bargap = 0.05
  )</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-f41a7ce18e96141e10ee" style="width:90%;height:345.6px;"></div>
<script type="application/json" data-for="htmlwidget-f41a7ce18e96141e10ee">{"x":{"visdat":{"131277d74f1a3":["function () ","plotlyVisDat"]},"cur_data":"131277d74f1a3","attrs":{"131277d74f1a3":{"x":{},"nbinsx":60,"marker":{"color":"rgba(55, 55, 55, 0.8)"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"histogram"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Rat Sightings (ZIP-Month)"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of ZIP-Month Observations"},"bargap":0.050000000000000003,"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2,2,6,9,5,2,4,8,4,5,1,2,2,2,3,2,4,6,6,6,4,4,6,1,0,4,2,6,16,8,13,15,3,18,7,3,7,1,6,3,16,27,11,18,10,8,3,4,5,4,6,11,17,5,3,7,10,2,3,4,3,3,7,4,12,12,6,5,3,3,4,2,20,12,6,8,6,23,10,20,10,17,13,2,8,12,11,10,10,13,10,14,14,19,9,13,11,10,18,13,17,31,20,24,25,16,11,16,10,12,11,13,18,18,27,16,10,15,11,15,12,3,16,14,8,19,15,16,26,4,5,12,11,7,10,10,10,11,19,13,13,14,14,4,3,2,4,4,6,11,12,8,7,13,8,3,8,6,8,9,10,9,10,9,4,3,9,7,6,12,11,17,14,23,16,14,11,21,19,6,8,4,10,14,22,20,23,26,25,26,21,19,31,20,21,19,29,18,21,29,16,15,13,23,17,13,21,12,16,21,15,18,10,7,8,3,1,1,0,2,0,1,0,1,0,2,2,0,1,0,1,0,2,1,0,0,0,2,0,0,0,0,0,0,0,1,2,0,0,2,1,0,0,1,0,0,0,2,2,1,1,2,2,3,1,1,0,0,6,0,1,0,0,1,1,2,1,0,0,1,0,0,0,0,1,4,0,0,0,0,0,0,0,1,0,0,3,0,2,0,0,1,1,0,0,1,0,1,0,0,1,0,0,1,0,2,1,0,0,0,0,0,2,2,0,1,1,2,1,1,0,0,0,3,1,1,10,0,1,4,3,3,3,4,2,1,0,0,2,0,0,2,0,1,0,2,0,2,0,1,0,0,0,1,0,0,2,0,2,2,0,1,2,1,1,0,2,0,0,1,0,0,0,0,0,2,1,0,1,1,0,0,1,0,1,0,1,0,0,0,4,9,3,0,0,0,1,0,0,0,0,0,2,1,0,0,0,1,0,2,0,0,1,1,0,1,1,0,0,1,1,0,0,0,2,3,4,0,2,6,4,3,0,1,0,0,0,0,0,0,1,1,0,2,0,0,0,0,1,0,0,7,0,1,3,2,1,3,0,2,1,1,0,1,1,5,1,2,2,0,3,2,3,3,3,2,3,8,8,3,3,2,0,0,3,3,0,0,2,1,2,2,1,1,12,8,15,14,16,26,13,18,6,9,5,10,5,3,5,8,9,12,11,12,22,5,17,3,11,8,14,25,42,26,31,37,27,32,37,29,29,13,17,23,32,28,28,14,27,16,24,17,13,10,8,12,20,12,19,21,22,25,9,8,10,8,7,12,13,14,21,24,15,22,10,5,3,2,4,2,8,2,2,2,7,2,0,1,3,2,1,0,1,1,3,1,0,2,1,0,3,0,0,1,2,2,1,1,4,3,4,5,5,5,7,2,8,6,5,5,7,7,6,6,10,5,7,2,5,2,3,7,7,2,2,3,8,3,0,4,3,3,4,6,9,5,7,2,4,1,5,9,11,11,14,6,12,15,8,3,3,4,8,8,10,10,17,13,9,10,5,6,9,9,11,12,14,30,20,28,11,11,14,9,19,16,11,15,17,16,16,20,10,19,15,11,19,9,10,20,21,13,13,12,13,8,10,7,5,14,12,9,17,16,17,8,18,14,3,2,8,6,7,10,13,10,7,5,8,2,7,3,6,4,4,4,8,6,3,3,7,1,4,2,2,4,6,9,4,2,6,10,12,9,7,8,7,4,4,11,9,13,12,14,9,6,11,10,9,10,6,5,11,7,10,16,11,6,1,5,7,5,6,8,8,7,7,10,8,3,5,1,4,2,7,9,5,8,12,13,8,8,10,5,5,2,7,12,14,9,8,6,6,10,0,0,6,4,6,6,14,15,24,28,23,24,9,7,9,5,4,5,9,12,15,10,8,6,5,3,5,3,9,8,7,8,16,12,10,8,5,2,7,3,1,7,7,3,5,2,4,7,6,0,8,3,6,17,20,9,7,4,4,5,3,5,5,10,13,5,9,14,8,4,8,7,6,7,11,7,18,11,10,14,23,18,24,44,15,14,11,14,15,16,21,19,21,23,18,21,15,14,15,12,24,20,18,8,20,16,27,17,15,9,11,14,8,8,17,10,11,11,6,16,7,5,4,6,4,4,6,3,4,4,6,0,1,2,7,9,4,4,12,8,14,13,9,3,3,10,11,8,8,15,5,5,11,6,6,7,7,8,1,1,10,10,16,15,13,13,10,7,8,4,15,14,9,8,14,26,10,7,15,4,5,2,2,2,6,3,4,4,11,11,9,10,8,8,0,0,0,0,1,1,1,0,1,5,4,0,0,0,0,1,0,0,1,2,0,0,1,0,0,0,0,0,2,2,0,1,3,2,3,2,0,2,2,3,0,2,1,5,2,3,2,1,2,1,4,4,9,2,7,15,9,3,2,7,6,1,0,2,2,1,2,0,1,0,1,0,0,2,8,4,3,2,1,2,5,4,1,0,1,0,0,2,1,0,0,1,3,2,4,0,0,0,5,0,1,2,2,0,0,0,2,0,5,3,1,0,2,4,1,3,3,3,1,1,1,1,3,5,0,4,2,6,5,0,0,2,2,4,11,6,2,4,4,4,2,3,4,0,5,4,1,11,4,9,10,3,3,4,6,2,2,5,6,6,14,3,5,6,8,3,2,7,5,1,8,8,11,5,8,5,11,15,12,10,12,7,12,5,7,20,10,12,10,8,9,11,14,18,27,27,16,16,17,28,25,13,12,7,5,8,3,1,5,6,6,16,9,15,12,6,0,2,2,3,3,1,0,0,2,2,0,2,4,1,2,1,1,5,4,4,3,1,3,4,2,3,6,5,8,13,16,16,16,12,8,13,7,7,15,21,9,15,27,21,23,14,12,5,8,16,7,17,17,24,14,11,6,8,13,7,8,13,18,12,14,13,23,13,8,8,7,10,2,6,6,3,1,1,2,3,3,4,2,1,2,1,4,2,7,2,3,5,3,2,0,2,0,1,0,4,5,3,2,2,2,6,2,5,3,2,5,2,5,4,1,5,3,5,1,2,1,4,7,3,4,10,11,5,9,0,6,3,1,3,0,6,2,3,3,2,5,1,1,0,12,12,11,21,22,15,23,21,19,14,13,8,15,24,13,11,10,9,8,9,9,6,4,7,6,6,11,20,8,9,11,16,6,7,11,9,7,11,16,12,12,29,30,19,25,8,11,19,25,15,20,31,22,17,30,46,28,20,17,14,18,17,13,20,18,32,29,35,27,16,14,11,12,9,17,29,32,31,23,40,39,28,10,8,26,30,17,20,34,36,33,20,28,12,10,5,12,3,11,20,22,36,56,30,45,35,39,34,43,38,56,42,46,62,46,49,50,24,32,14,25,37,33,30,28,41,39,41,31,23,18,22,14,24,30,27,48,35,43,30,28,30,21,16,26,23,28,45,92,46,30,35,25,22,24,19,37,48,44,33,37,48,37,49,51,48,46,23,41,29,41,49,69,71,60,76,64,82,92,63,58,64,66,59,106,110,119,124,81,56,63,60,70,41,50,56,63,43,60,72,47,40,44,21,43,25,30,30,35,36,43,44,39,50,29,26,11,13,6,14,27,21,41,44,43,18,16,13,21,20,4,12,31,18,18,30,34,17,17,17,24,13,57,39,51,34,44,49,49,74,58,37,22,45,53,33,69,60,48,46,34,35,31,24,39,25,30,42,43,27,36,39,34,31,25,15,21,17,25,37,46,48,43,32,23,28,19,20,16,13,22,21,29,27,48,34,26,17,10,16,13,18,21,11,17,12,26,41,27,14,15,16,54,14,73,27,51,58,77,49,44,44,25,31,21,55,49,27,44,57,52,79,43,41,25,17,26,28,18,22,32,48,41,49,35,35,20,24,22,27,16,23,43,38,66,27,34,35,27,13,6,6,1,5,8,10,8,10,4,9,8,4,10,9,8,19,13,14,23,24,17,10,13,4,11,7,14,26,19,16,15,24,8,21,17,22,5,9,18,21,27,27,27,32,16,16,10,9,16,6,9,16,27,24,27,33,34,16,19,16,31,21,27,21,25,25,25,32,38,32,18,18,10,6,15,33,23,34,31,24,19,7,10,9,19,7,13,23,25,19,19,23,16,26,16,4,18,15,6,21,22,24,21,23,35,23,30,18,19,15,31,32,39,33,26,28,31,27,21,17,21,20,28,32,27,18,26,24,29,31,11,7,23,10,14,17,30,17,25,23,30,20,11,9,20,10,11,8,11,10,22,21,12,16,8,10,7,4,4,5,9,7,3,10,7,13,13,9,9,19,13,25,29,41,40,17,21,19,11,14,11,20,20,21,16,25,24,14,14,16,30,9,9,14,12,18,14,15,28,18,12,2,5,11,10,10,9,9,23,18,25,24,20,20,9,9,16,13,18,9,12,25,24,17,16,18,10,6,11,16,10,21,24,20,15,15,13,20,23,17,30,29,17,12,25,25,34,23,16,19,18,32,34,20,19,28,29,33,37,59,29,30,12,18,24,17,25,32,19,26,25,22,21,19,16,16,18,22,19,20,37,18,41,27,25,22,31,24,11,17,2,15,33,24,20,14,13,19,10,10,9,14,8,12,15,10,17,30,32,12,9,7,17,4,16,16,16,16,19,23,24,21,18,18,12,21,10,9,19,11,11,11,10,17,8,12,12,4,23,25,16,13,10,12,6,17,17,19,13,19,15,22,16,10,17,17,10,18,21,16,12,8,6,9,8,3,12,9,6,4,7,5,5,3,4,5,7,10,12,9,14,8,7,14,14,7,11,15,12,19,13,19,12,21,30,42,26,9,14,24,20,22,20,24,15,5,9,11,16,17,17,10,16,10,12,18,16,14,11,11,11,19,21,19,24,17,20,24,30,28,14,15,7,3,10,8,9,8,15,12,14,10,5,15,5,8,6,7,10,4,6,11,9,23,16,6,18,12,18,14,21,24,16,16,24,17,14,6,12,15,4,14,25,11,29,17,16,12,16,12,11,11,20,12,9,17,17,12,15,36,12,15,10,5,16,20,25,16,24,30,23,18,11,10,5,8,12,14,25,17,27,19,16,29,11,15,17,12,4,5,10,14,10,23,17,20,9,5,17,4,6,10,11,18,12,16,24,23,18,14,10,12,14,13,20,9,17,13,11,14,7,3,9,10,9,11,12,7,13,15,17,14,9,8,9,11,6,9,6,6,10,12,11,27,9,10,1,3,2,6,2,1,4,5,8,2,1,0,3,2,0,1,9,7,9,8,6,8,3,8,3,9,7,10,12,4,11,11,6,12,7,7,6,5,4,7,11,18,21,13,21,7,4,4,6,14,7,10,4,12,9,18,20,13,4,7,7,4,11,5,8,3,6,8,7,3,7,5,3,4,5,9,9,16,8,11,7,8,7,3,0,0,0,1,3,7,13,9,7,7,1,2,21,2,3,6,11,0,3,6,9,2,2,6,5,3,2,1,7,4,7,11,10,7,11,7,11,8,6,7,10,11,13,19,10,8,9,3,4,4,1,8,19,7,6,12,20,11,10,5,1,1,0,0,4,2,4,0,2,1,5,3,3,4,3,4,6,3,5,4,3,3,2,0,3,0,6,2,1,4,1,2,5,6,5,2,3,3,4,8,5,2,10,6,6,10,1,4,8,5,3,2,4,1,2,4,3,4,6,1,2,2,3,0,3,1,5,5,1,4,1,0,3,2,5,5,4,5,4,8,7,9,1,3,11,5,14,1,4,4,10,12,8,4,8,3,6,11,10,13,13,5,20,21,14,20,20,4,14,6,10,5,13,7,7,24,10,15,5,9,14,3,13,6,8,3,9,13,4,9,1,5,7,12,11,15,12,19,21,35,9,16,14,12,5,2,4,4,4,3,5,5,6,7,2,6,2,7,2,3,3,5,5,8,3,8,2,2,3,4,7,11,5,4,12,17,26,14,9,8,10,12,10,19,21,25,20,14,3,11,6,5,18,8,11,10,17,8,11,11,7,11,9,6,4,6,6,7,4,16,14,11,9,10,8,8,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,4,1,7,6,5,2,3,8,1,2,4,1,0,2,2,1,2,4,2,2,0,1,1,2,3,0,6,1,5,1,3,2,1,4,3,2,2,6,2,4,9,5,4,4,2,7,2,5,6,4,6,4,5,2,4,7,5,6,3,0,0,3,5,4,5,2,4,4,7,6,2,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,3,0,0,0,0,2,0,1,0,0,1,0,0,0,0,0,1,0,1,1,0,2,2,3,16,6,5,9,4,2,5,5,3,2,9,3,2,4,5,4,9,10,6,9,8,9,14,3,14,19,10,14,12,19,16,16,8,8,3,3,7,4,7,18,13,11,21,5,7,3,5,6,4,16,5,9,15,19,17,11,5,5,5,6,5,13,5,4,6,7,3,8,9,7,6,5,5,3,3,8,15,6,7,3,2,1,4,4,6,6,17,4,12,16,16,18,16,15,18,9,20,20,9,16,26,22,29,31,14,11,10,13,23,24,28,16,15,20,12,14,11,14,20,14,20,17,15,12,15,25,25,17,21,11,15,10,13,15,19,9,29,15,36,11,11,11,1,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,1,0,1,0,0,0,1,0,0,1,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,3,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,6,5,4,7,5,18,19,9,6,9,7,1,3,10,10,6,7,10,14,8,7,8,3,8,4,5,19,9,4,13,17,11,16,9,9,2,5,2,8,7,10,6,11,8,11,6,2,1,13,6,4,11,9,9,18,16,10,3,1,2,7,5,6,3,6,4,11,12,3,2,4,4,1,1,3,9,2,7,6,3,1,5,1,2,0,2,2,1,5,11,0,12,3,2,3,11,1,2,7,7,2,7,2,6,6,4,3,1,2,0,0,5,3,6,4,8,4,2,1,0,5,1,1,2,2,4,1,3,7,4,1,0,3,0,4,1,5,1,7,4,3,3,4,4,4,2,0,1,2,8,4,12,10,3,1,5,0,1,1,2,4,2,8,2,1,6,0,1,0,0,0,4,2,5,6,2,1,2,4,2,1,5,5,3,8,4,4,6,5,4,3,3,3,0,3,1,5,2,3,3,3,2,1,3,1,2,4,2,4,4,2,3,1,6,2,0,4,4,2,2,4,10,6,10,10,3,4,4,3,1,1,0,3,6,3,8,1,2,1,2,10,5,1,4,6,4,4,5,5,6,1,2,4,3,6,9,7,6,10,8,8,4,2,3,1,1,2,1,30,2,8,3,1,2,1,0,1,0,8,4,4,8,10,8,7,2,7,0,4,3,3,3,1,17,8,6,3,1,2,3,1,2,3,2,14,3,9,7,3,3,4,0,1,4,3,11,11,6,2,8,7,11,5,4,2,1,6,3,6,8,18,12,13,5,2,2,17,3,3,7,12,11,12,10,9,3,2,1,3,5,4,10,6,5,12,16,14,2,1,1,1,6,3,6,9,17,6,7,12,5,10,2,6,3,4,3,7,3,6,10,5,4,4,1,4,1,10,4,9,10,5,12,7,6,2,3,2,3,4,0,5,17,7,7,12,8,2,3,1,1,1,5,6,9,13,10,2,8,0,5,2,2,3,13,13,14,7,8,8,5,6,1,1,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,2,1,2,2,0,1,0,1,1,0,0,0,0,2,1,1,0,2,1,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,1,3,2,1,1,1,0,0,2,0,0,0,0,1,0,0,3,1,1,0,0,1,0,0,1,4,4,7,8,1,2,1,0,0,1,1,3,1,3,7,8,4,4,1,1,2,3,7,3,1,4,5,4,8,3,1,1,0,5,4,14,13,12,9,7,3,1,5,2,3,1,2,2,12,6,7,7,5,3,4,5,2,2,3,2,5,7,9,4,5,2,3,1,0,0,4,1,2,5,2,1,0,2,1,0,1,1,0,1,5,6,0,3,1,2,0,4,1,1,0,2,2,6,9,7,2,3,3,0,0,2,2,2,1,1,1,3,2,0,1,0,2,0,0,2,1,3,3,3,0,1,2,1,0,0,1,0,2,2,2,2,3,1,3,2,1,4,3,3,7,16,13,12,7,5,4,5,3,2,3,2,12,12,3,6,14,6,3,2,3,4,6,5,5,9,14,8,6,4,1,3,3,10,10,7,5,10,7,5,5,5,0,0,1,0,2,9,5,12,9,7,9,10,1,2,4,3,4,3,4,7,5,9,7,8,3,2,1,8,1,4,11,15,11,9,7,18,1,3,3,6,3,1,6,13,9,16,17,5,6,1,4,1,4,3,8,15,9,9,9,8,2,2,1,0,4,10,12,19,24,9,4,11,1,0,1,4,5,7,9,9,20,24,6,6,2,4,3,10,4,11,15,18,21,14,3,5,1,3,5,5,5,7,9,13,20,18,16,14,12,12,12,11,5,3,4,10,10,10,6,2,2,2,2,4,2,6,7,14,5,6,7,13,1,1,0,1,8,4,8,15,7,3,6,5,4,1,2,10,2,2,9,5,13,9,7,10,1,6,1,6,9,6,7,11,5,15,12,6,2,3,6,10,5,8,14,7,7,12,6,9,8,3,8,2,7,1,6,3,11,14,12,6,5,11,9,9,16,11,14,15,27,24,32,19,10,22,15,8,22,17,14,18,27,14,14,21,15,9,10,4,11,19,13,26,27,29,12,14,9,2,6,6,10,8,13,14,8,14,9,10,8,9,15,10,17,15,16,11,8,8,15,6,9,8,7,3,3,5,7,11,10,16,15,21,18,14,20,14,13,15,19,24,15,10,14,20,13,21,27,21,5,37,33,29,29,29,21,20,11,14,9,14,15,19,15,8,16,24,19,21,10,10,23,18,23,26,34,31,21,25,38,24,15,10,18,56,9,15,10,11,14,37,25,12,5,7,9,17,13,9,22,18,8,18,6,18,13,18,18,12,24,22,16,28,12,24,26,23,22,19,25,21,27,15,17,17,17,13,20,21,14,6,17,13,14,15,14,22,13,16,21,10,11,17,20,13,11,13,10,14,7,14,22,14,3,15,5,6,0,2,10,4,10,6,5,8,1,4,1,4,4,8,9,5,2,3,9,13,10,8,7,10,13,33,6,7,15,18,12,17,12,8,11,15,33,21,16,13,13,8,8,6,4,8,6,12,8,13,10,7,7,11,4,6,7,8,7,4,11,2,9,2,9,11,10,13,15,5,8,5,10,5,19,14,11,12,12,9,11,6,10,5,18,7,12,4,16,12,15,21,7,10,14,7,7,15,15,11,15,22,14,13,19,13,14,14,17,20,20,18,7,13,13,9,10,4,16,6,8,11,10,12,20,17,12,8,7,22,11,12,10,11,28,12,11,8,22,14,14,9,22,28,18,19,19,18,13,16,14,21,14,11,24,12,7,8,21,25,16,17,21,32,19,19,22,22,27,25,41,40,54,29,33,26,23,25,22,17,39,20,49,25,33,19,31,19,23,12,14,19,11,23,16,18,38,40,24,31,19,27,19,18,15,19,29,31,23,18,17,29,20,15,8,11,14,10,15,19,18,10,9,21,11,10,15,8,14,12,11,12,22,20,14,32,24,14,14,12,15,17,21,28,32,24,32,31,21,19,20,14,14,19,23,19,24,29,27,21,20,15,26,13,15,9,16,15,19,32,20,18,10,8,18,8,10,14,16,8,20,18,18,10,12,13,23,15,18,18,33,21,10,15,9,16,14,9,18,7,10,6,12,20,14,29,21,21,21,11,17,19,23,54,29,23,36,26,11,31,25,24,21,15,31,21,21,38,19,28,30,23,20,16,27,19,16,17,17,12,30,31,24,18,15,17,13,8,16,14,24,21,26,13,19,21,19,10,11,11,10,11,13,19,14,18,12,11,6,6,4,4,4,7,12,10,12,22,13,14,12,19,12,8,14,8,23,25,30,38,39,33,16,22,14,12,13,14,18,14,23,19,19,13,15,17,17,12,13,16,19,15,15,16,17,16,11,15,8,11,14,19,23,20,21,16,17,20,10,8,14,10,9,14,9,8,6,24,24,24,9,9,10,9,7,3,4,13,12,9,6,12,3,10,7,6,10,11,14,11,13,10,13,5,11,11,16,9,11,15,29,9,19,13,22,16,11,11,10,15,12,10,19,19,17,15,25,24,16,16,20,21,20,24,29,17,21,14,15,24,9,23,6,5,9,7,12,9,2,7,4,2,1,4,2,1,1,0,10,11,2,4,5,2,4,1,1,2,2,5,6,13,7,3,10,7,5,3,2,3,5,5,4,7,4,8,4,8,6,3,6,1,2,10,5,5,5,9,6,5,2,5,8,8,12,6,5,7,10,10,20,20,3,2,8,8,15,21,15,11,25,15,12,15,6,6,6,10,5,4,6,11,11,10,18,15,11,9,6,5,16,19,26,27,19,25,12,29,13,8,6,8,12,12,12,25,28,16,13,22,19,13,12,8,7,17,11,29,26,17,30,27,18,22,15,14,21,18,17,31,16,25,14,12,20,21,15,7,10,6,4,11,16,18,8,19,7,11,6,4,6,2,14,5,6,12,8,10,9,3,7,6,5,14,23,24,24,16,20,23,10,23,16,19,12,22,27,43,44,31,22,20,14,8,9,21,10,12,13,18,23,17,18,11,12,10,14,11,9,19,15,16,14,15,12,9,16,10,0,0,0,1,0,0,0,0,0,1,0,0,2,1,0,0,0,0,2,1,0,0,0,0,0,0,1,0,0,1,1,2,2,1,2,0,0,0,0,0,0,2,5,0,10,3,0,0,0,0,4,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,2,1,0,5,4,3,6,4,3,1,5,2,0,2,0,0,1,7,4,6,2,5,2,0,0,0,0,0,5,5,9,5,13,4,1,1,1,0,0,3,2,0,4,7,0,5,3,13,4,1,2,3,8,2,2,4,4,0,3,3,1,1,1,0,1,2,3,2,3,1,2,3,2,8,7,3,8,9,3,13,9,2,6,1,3,4,4,4,4,10,7,12,12,6,4,6,1,2,2,5,3,7,8,13,9,8,12,6,8,5,6,4,7,10,13,11,13,8,4,5,9,7,7,9,4,9,5,7,12,10,8,3,3,4,4,6,8,5,9,10,11,10,7,4,3,18,16,16,21,17,18,22,26,14,23,15,17,15,9,7,11,31,20,17,13,31,42,16,17,22,23,21,34,29,38,34,33,31,30,24,25,28,22,24,22,27,29,39,27,28,23,15,25,32,19,48,23,24,29,40,36,31,21,35,16,30,40,46,41,49,41,32,45,38,37,27,16,12,7,16,4,6,7,16,18,17,9,11,10,16,7,7,7,17,20,13,19,16,10,10,17,16,11,36,24,36,36,30,20,34,35,34,24,18,14,20,21,27,24,23,18,21,24,17,15,35,28,18,16,16,32,22,28,24,33,11,12,22,14,17,21,65,49,43,33,20,25,14,13,3,3,9,5,10,7,12,19,13,7,2,7,6,3,6,2,4,6,11,16,7,6,3,6,5,5,7,9,15,12,13,15,12,8,9,5,11,2,3,4,14,5,14,4,8,15,8,5,7,1,10,11,13,9,17,14,4,5,6,2,1,4,5,8,9,5,8,12,7,10,7,0,0,2,5,9,1,4,4,4,2,0,0,0,2,1,1,6,13,6,5,7,8,8,3,3,0,1,3,7,6,4,8,2,6,7,7,6,1,7,9,4,9,19,12,4,5,3,5,4,1,3,4,5,7,9,10,4,5,6,1,7,6,3,2,5,7,5,8,6,5,5,8,2,1,0,0,1,2,0,2,5,2,4,3,0,2,2,1,0,0,4,1,2,3,0,1,0,1,0,1,5,5,7,8,9,3,6,2,9,11,5,10,8,8,20,2,2,2,3,7,2,0,1,2,4,1,3,2,2,1,0,0,0,3,1,5,5,4,6,8,8,8,0,1,4,15,9,16,9,13,11,22,23,28,18,12,14,9,10,16,23,28,20,27,32,29,28,14,25,18,14,29,42,50,54,30,39,36,40,26,26,25,22,13,24,26,35,24,29,20,17,20,9,11,10,12,16,18,12,21,31,26,14,7,11,15,16,14,36,26,21,27,24,24,22,13,5,3,6,5,6,4,4,5,4,7,5,0,2,3,1,4,1,2,14,8,11,7,8,0,1,3,1,6,6,7,7,5,15,7,10,9,3,4,0,6,3,5,4,9,6,9,3,5,6,11,4,6,7,6,8,8,7,4,7,2,9,9,5,4,9,11,7,11,13,14,1,2,1,2,3,4,0,1,5,2,1,5,5,4,1,1,8,4,4,10,8,8,3,14,4,8,16,1,3,5,6,5,9,14,17,9,18,7,5,5,5,10,9,6,15,7,12,6,3,2,0,6,3,4,5,3,4,12,2,6,3,3,2,10,3,5,6,3,5,1,1,8,6,6,0,0,1,0,2,0,0,0,0,1,0,2,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,1,0,0,3,1,3,0,2,0,2,1,0,1,1,2,1,0,1,1,0,0,1,0,1,0,1,0,1,1,0,2,0,0,1,0,1,2,3,1,0,2,2,1,0,1,0,0,0,1,2,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,3,0,0,1,6,5,3,2,1,1,0,0,0,3,0,1,0,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,1,1,1,1,2,0,0,0,0,0,0,0,0,0,1,3,0,1,2,0,0,0,0,1,0,0,0,0,3,0,1,1,0,0,1,1,1,0,1,2,0,1,1,1,0,0,0,0,0,0,1,0,1,0,2,0,0,0,1,0,0,0,2,1,0,2,2,4,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,2,1,0,0,0,0,2,6,16,8,4,8,13,15,10,9,5,4,5,6,3,14,4,8,11,6,13,12,3,1,4,6,12,10,17,20,8,12,15,5,8,9,11,6,4,11,13,29,27,14,8,7,5,4,6,14,5,37,23,12,19,8,13,14,6,1,4,5,10,8,13,15,17,12,15,9,8,6,0,1,1,2,3,1,3,3,5,5,2,3,4,4,9,8,9,6,12,7,7,4,4,7,4,5,27,12,7,8,6,13,2,5,10,9,10,7,9,9,11,28,17,23,19,10,9,4,8,12,8,8,6,18,15,17,14,10,10,5,5,17,5,14,10,20,14,29,11,9,13,5,2,0,6,4,13,4,7,9,2,3,2,1,0,0,4,1,11,5,0,13,13,9,6,0,7,4,9,11,5,3,4,17,9,16,9,3,5,8,10,5,17,21,19,14,24,17,5,9,8,13,14,29,17,11,21,14,16,12,16,5,15,14,17,17,24,20,30,23,21,19,11,7,0,3,7,5,8,7,12,14,9,3,1,4,3,1,2,1,0,3,5,5,2,2,4,1,2,5,4,5,4,3,8,4,5,2,1,3,13,10,11,2,9,10,13,21,18,5,8,3,18,18,14,17,14,15,16,15,7,4,5,9,9,10,4,14,11,23,22,26,9,14,8,5,2,1,0,1,1,3,5,5,2,2,0,1,7,8,7,8,23,9,9,8,18,49,38,15,16,9,20,17,23,20,15,17,6,27,9,6,6,10,18,12,14,22,22,45,16,39,41,13,19,20,17,14,18,18,11,16,8,19,9,17,11,12,20,26,20,21,31,15,19,18,7,6,3,4,9,11,3,8,8,4,16,7,5,5,1,3,7,3,3,6,14,5,8,7,2,0,1,3,1,1,5,14,8,10,6,3,3,11,1,3,3,5,17,17,13,9,11,2,4,4,9,12,9,9,17,4,15,14,11,7,6,11,19,14,7,9,10,12,14,16,11,7,9,3,0,0,0,0,0,0,0,3,1,3,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0,1,0,1,1,0,2,2,0,9,5,8,13,11,6,11,25,14,13,9,4,6,5,10,11,14,16,19,5,16,11,8,5,10,7,14,24,23,16,35,36,15,23,12,15,12,10,17,15,26,26,22,38,44,23,15,10,13,17,11,26,22,26,35,32,17,33,25,11,17,18,19,26,23,36,22,15,15,22,14,5,8,5,7,23,6,7,9,13,10,8,4,10,8,11,7,4,5,12,14,16,28,13,6,4,9,3,5,10,7,11,15,14,21,10,22,12,12,15,24,15,15,22,30,27,18,15,12,23,30,11,32,13,14,11,21,21,22,23,31,27,12,5,8,16,22,8,21,11,26,28,24,11,3,1,1,0,3,2,0,1,4,3,7,3,2,0,6,2,10,2,5,8,1,4,1,4,5,1,3,5,1,9,3,3,6,2,3,13,9,7,11,13,16,6,9,6,8,5,9,3,6,8,6,9,17,15,11,16,6,10,4,4,11,9,3,8,4,8,4,9,11,8,7,13,20,6,18,18,68,26,18,19,30,16,10,6,7,4,4,16,18,37,43,12,12,18,8,3,10,6,8,19,19,26,19,16,26,18,16,15,13,12,23,20,22,28,25,21,29,16,22,8,22,17,19,40,28,32,35,40,38,17,21,15,19,28,20,26,26,19,41,51,21,19,13,9,16,11,12,14,16,26,33,32,27,14,5,9,15,7,6,10,23,10,28,24,32,19,16,14,8,11,27,18,33,47,48,33,28,47,29,27,18,17,12,27,43,29,36,35,41,37,17,16,18,30,21,33,49,41,45,83,89,34,28,30,39,30,25,19,41,43,59,32,40,32,27,20,19,5,14,38,26,42,29,37,26,12,11,9,18,20,16,19,23,22,32,27,10,23,17,20,24,18,30,34,31,29,43,40,34,29,20,19,12,21,37,35,45,48,45,56,24,31,22,10,29,28,21,20,21,37,27,28,20,33,19,16,14,16,17,21,30,29,28,22,23,11,13,12,10,7,8,15,8,10,20,19,16,6,4,4,13,10,4,10,14,21,15,19,20,12,13,13,19,5,10,14,24,27,35,24,19,18,28,20,19,22,14,21,33,27,19,15,19,17,23,15,17,24,10,22,20,32,23,23,30,20,29,18,12,5,11,19,15,13,17,13,15,20,8,12,5,6,6,3,5,10,4,10,5,6,6,2,11,2,5,19,10,9,7,6,11,13,8,9,5,2,19,12,17,31,20,9,20,22,16,5,13,6,18,19,25,28,37,23,27,23,15,6,32,26,26,24,13,27,33,36,22,21,14,7,15,14,27,26,50,38,32,53,30,39,26,14,1,3,8,1,6,2,3,1,2,5,3,0,5,2,0,1,2,4,5,9,6,3,5,5,4,6,7,4,4,4,10,5,14,21,6,4,3,1,13,6,7,5,8,6,13,1,3,3,6,5,10,8,6,11,9,7,18,7,9,7,13,14,6,10,24,15,11,11,9,10,6,10,5,18,20,37,31,29,24,16,13,15,17,7,7,17,11,16,25,21,15,15,16,11,22,7,9,8,20,27,27,25,43,29,26,32,29,18,19,26,33,29,47,39,50,30,28,40,29,36,38,42,52,44,55,48,75,75,65,44,30,21,31,42,45,37,60,36,59,68,46,35,20,16,7,4,7,11,9,18,23,13,9,6,10,10,10,11,4,2,11,12,15,14,10,10,14,13,11,4,11,13,10,13,13,19,9,13,5,11,5,4,16,6,15,19,19,16,20,19,13,13,10,9,10,18,15,8,18,20,12,13,8,8,13,6,6,11,25,19,13,12,17,10,14,23,16,15,12,19,20,24,16,17,15,10,14,11,17,19,14,14,13,15,16,10,22,12,12,10,22,14,18,30,34,60,37,26,20,35,20,27,20,23,51,42,36,40,23,39,37,24,20,25,37,25,30,23,26,18,27,36,43,29,32,25,31,24,20,21,26,21,37,31,38,37,30,28,3,3,1,9,3,4,14,7,3,5,1,3,6,6,7,2,6,3,15,10,23,16,3,0,6,3,3,7,8,8,5,3,2,5,2,8,11,4,13,5,5,10,8,11,9,10,4,4,3,7,7,5,8,5,15,10,17,11,3,5,4,11,14,6,11,9,8,12,22,7,13,4,14,16,21,33,68,35,45,22,43,15,24,9,10,18,19,29,29,20,26,28,19,19,14,13,10,18,45,41,58,39,38,32,40,36,13,14,25,36,34,40,38,53,51,57,40,16,19,5,30,31,37,48,47,57,44,40,43,32,36,23,39,49,41,46,69,47,47,45,44,42,25,23,16,20,16,35,42,53,53,56,36,25,19,30,27,26,22,29,57,62,65,76,36,43,21,17,36,26,48,81,76,76,78,50,69,107,60,45,31,35,48,67,88,77,82,90,42,45,28,28,31,39,45,60,69,86,56,67,60,46,28,30,47,20,25,50,55,55,53,60,56,27,23,17,4,13,13,23,25,32,19,13,16,13,13,7,4,11,23,8,8,24,10,25,8,7,13,6,11,6,17,31,28,42,42,42,41,22,25,26,16,16,17,16,25,35,29,22,18,12,17,15,15,13,18,31,25,18,23,14,11,21,8,12,8,21,26,24,24,30,27,23,24,18,14,2,6,2,5,17,11,11,24,7,17,14,3,4,5,10,3,3,8,4,7,3,13,12,8,9,3,3,16,6,7,22,20,18,21,28,9,10,15,17,35,29,30,45,41,22,28,21,15,16,25,14,30,22,31,25,30,26,26,21,21,17,34,22,15,26,23,39,58,40,42,21,22,13,10,2,7,5,9,4,10,9,2,10,7,5,6,8,3,5,7,9,13,6,9,24,5,5,3,13,24,13,10,14,6,6,12,6,4,5,16,8,8,9,16,19,10,31,14,10,5,5,16,15,18,15,16,22,11,21,20,9,11,11,6,6,12,10,15,13,15,9,5,8,6,8,14,10,9,10,11,16,11,11,6,10,5,4,8,16,16,11,15,18,23,14,11,9,17,8,11,9,19,34,26,18,14,14,18,15,8,19,16,14,22,16,32,38,48,33,44,28,20,15,19,16,9,21,33,23,31,42,19,19,20,22,36,45,34,32,74,53,46,33,38,16,17,9,21,24,27,35,51,30,51,46,45,35,35,22,29,27,27,27,49,60,52,49,62,48,20,33,34,22,46,53,65,63,68,83,43,64,37,45,41,26,54,63,68,78,57,68,66,36,22,38,38,38,43,41,49,61,65,71,32,36,27,22,31,24,29,35,58,65,52,59,59,33,47,29,7,7,15,31,10,11,17,6,10,12,21,2,5,13,12,8,29,12,15,15,10,13,5,7,8,9,20,11,23,22,20,36,14,33,17,11,20,8,29,14,32,34,44,21,29,26,15,8,26,30,27,41,57,45,45,46,31,34,24,26,19,16,29,18,24,32,21,27,28,38,17,0,3,3,9,7,6,8,11,11,19,11,1,10,3,6,4,1,5,4,8,9,15,3,7,3,5,2,4,14,8,8,6,13,8,4,2,3,5,3,5,2,6,17,4,10,9,11,2,3,1,10,7,1,8,6,3,5,4,3,7,12,10,3,13,17,17,13,10,15,14,12,9,7,0,1,5,4,3,7,8,9,6,9,5,3,12,5,1,1,6,7,2,4,6,9,5,1,6,3,9,10,5,6,4,5,5,13,3,7,5,6,6,2,2,6,6,8,8,2,5,5,3,6,2,9,12,6,3,10,5,6,1,3,3,7,3,5,3,3,8,5,6,7,4,2,11,11,23,19,27,19,11,28,14,12,13,11,10,11,7,9,7,10,7,9,26,6,8,7,17,8,16,18,41,24,28,17,24,49,60,27,25,25,39,50,39,34,31,27,24,21,27,20,36,11,30,22,19,15,19,24,20,27,46,19,30,26,22,34,30,22,28,13,19,30,17,14,22,26,24,31,21,33,17,27,23,32,22,23,27,16,22,19,26,29,38,27,25,37,16,21,24,15,39,47,42,78,48,54,32,47,46,33,33,37,44,49,62,76,83,80,54,44,32,30,34,50,41,37,26,48,54,45,28,30,21,47,49,60,48,57,60,54,54,60,38,36,20,29,0,1,1,2,3,3,3,7,3,3,2,0,0,0,1,4,3,1,3,1,1,3,1,1,0,1,4,0,10,3,9,3,12,13,1,1,4,3,2,7,13,13,7,13,8,10,5,5,5,4,11,6,8,5,17,9,10,5,1,16,10,6,18,8,11,8,10,5,10,4,2,9,1,1,0,2,4,6,9,0,4,5,1,1,3,3,1,1,5,2,6,6,8,5,3,0,1,2,2,6,10,7,5,9,5,15,7,8,3,3,8,5,10,4,8,4,6,3,4,2,1,4,3,6,4,12,15,10,4,11,8,6,4,1,9,9,10,15,19,4,6,7,2,3,2,1,4,7,6,7,7,11,5,15,13,2,2,7,1,5,11,11,3,3,8,7,3,3,6,2,3,5,4,8,7,8,36,47,32,30,3,6,14,18,13,12,18,25,13,10,18,5,4,7,6,20,26,12,19,15,10,12,26,8,21,14,15,24,29,16,25,30,39,42,22,15,3,2,7,3,9,9,8,8,8,11,1,1,2,2,6,8,28,16,6,6,4,5,1,2,3,3,6,4,9,46,28,19,13,19,6,12,8,11,11,10,16,31,37,16,15,15,16,4,16,11,11,13,21,37,39,37,20,21,13,15,18,35,20,34,33,23,16,24,28,19,16,11,2,2,1,6,6,1,5,10,7,5,4,1,6,7,6,14,11,12,15,5,6,6,5,5,5,2,11,8,11,14,7,4,7,5,4,8,1,2,14,13,20,16,10,8,11,9,3,4,5,10,6,11,12,14,7,17,12,12,12,9,6,9,16,16,18,17,12,14,9,15,4,1,11,13,23,40,68,44,49,36,33,35,20,10,21,17,13,9,30,33,46,29,34,26,18,15,20,17,30,41,60,66,55,56,29,33,34,24,18,18,31,32,39,31,43,47,41,37,27,27,24,25,32,48,19,23,40,37,20,27,22,27,37,41,35,36,48,32,40,34,48,28,23,10,4,9,8,11,4,11,8,16,8,10,0,3,1,8,4,7,7,10,10,11,11,10,3,0,4,1,8,8,8,8,4,12,5,3,3,7,4,6,10,10,10,11,8,13,2,8,5,2,5,3,16,8,14,15,30,12,14,4,1,6,3,6,9,12,14,11,30,8,9,7,11,1,9,6,17,21,8,8,12,10,9,11,9,9,7,5,7,4,13,9,14,10,13,7,14,11,11,15,26,25,16,25,37,34,34,35,38,21,9,21,14,19,19,22,29,13,20,12,17,12,10,9,18,11,28,25,15,11,18,10,11,11,18,34,35,21,28,18,15,15,27,18,12,8,7,3,4,7,7,12,12,6,1,6,4,4,6,3,10,2,1,5,15,11,5,3,3,7,3,5,7,13,6,10,6,12,13,13,6,5,1,7,7,9,22,13,7,17,9,10,4,12,8,7,8,10,10,9,14,12,10,6,6,4,1,4,2,1,6,6,13,7,8,8,4,0,21,20,25,31,38,19,20,25,16,22,22,15,19,37,14,13,44,26,25,39,24,13,7,7,13,8,37,49,45,43,40,59,53,55,56,52,41,46,83,59,62,99,47,58,55,24,24,21,60,38,36,41,48,39,30,55,45,33,26,18,38,26,29,54,53,52,44,51,26,28,22,15,33,21,17,42,96,72,35,75,92,82,38,21,43,22,32,19,41,53,56,46,44,36,19,26,31,35,46,68,84,76,75,67,56,107,57,42,47,28,40,44,52,57,66,64,45,43,25,28,43,36,36,62,44,48,58,70,51,40,22,26,34,49,54,45,66,56,34,50,44,35,24,27,0,0,1,0,0,0,2,1,2,0,0,0,0,0,0,0,1,1,0,2,0,6,0,0,0,0,0,0,1,0,1,0,2,0,2,0,0,0,3,2,4,3,5,1,1,0,0,1,2,0,1,2,0,2,7,1,1,0,1,0,0,0,1,0,0,2,0,3,1,3,1,1,5,4,5,6,4,6,9,8,2,2,2,2,5,4,3,3,4,3,4,7,5,1,4,2,2,2,2,6,2,4,7,5,5,6,6,6,6,0,4,11,5,8,10,6,6,1,3,2,6,5,11,7,5,9,11,7,7,5,4,4,8,4,6,8,8,9,3,3,8,8,10,3,4,1,2,8,4,8,4,5,2,4,1,4,2,5,5,5,4,7,4,5,6,4,6,11,3,2,4,1,7,7,8,7,5,7,4,4,2,8,12,9,18,12,9,12,9,18,12,31,19,18,13,8,13,7,12,11,4,12,2,5,2,6,4,4,5,3,3,3,4,3,4,1,1,1,0,1,0,2,5,3,1,1,0,3,5,2,2,1,3,3,5,4,0,0,0,0,0,0,0,1,1,1,4,2,4,1,4,4,2,0,2,1,0,1,3,0,1,1,0,0,5,1,2,0,6,1,4,7,3,0,0,0,0,1,1,1,2,1,0,0,4,0,0,0,4,0,3,3,5,3,7,7,9,7,5,3,4,8,1,2,14,3,8,17,2,3,0,1,2,1,5,5,7,6,9,5,2,2,5,1,0,2,4,2,9,7,6,15,4,7,2,2,1,7,4,16,13,11,6,5,4,2,5,0,1,2,6,5,2,4,4,4,4,6,0,1,0,3,4,5,2,2,4,5,2,0,0,0,1,2,3,4,2,2,4,2,5,2,0,1,0,1,1,1,2,4,6,2,2,2,1,0,1,1,3,3,3,6,5,2,4,3,2,4,0,5,4,12,6,13,7,4,7,1,4,3,6,6,3,4,12,3,15,3,2,5,6,1,1,0,2,2,0,0,1,1,5,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,0,0,2,0,2,0,0,0,0,0,0,2,0,0,2,0,0,3,0,1,0,1,0,0,1,0,5,0,2,0,2,3,0,1,0,1,5,3,0,0,3,1,0,0,0,1,2,1,0,2,1,4,1,0,0,0,0,2,0,0,3,13,4,8,4,1,3,1,1,0,5,4,1,2,1,1,1,1,1,0,0,3,1,1,3,0,3,6,9,4,3,1,1,3,4,6,3,2,4,1,7,6,3,2,8,2,6,3,1,6,6,4,15,6,1,3,0,0,0,0,1,1,0,0,1,2,1,0,0,1,0,0,0,0,1,1,1,1,0,0,0,0,1,0,2,0,2,1,0,0,0,0,0,0,0,1,0,1,1,0,0,0,1,0,0,0,1,1,0,2,1,1,0,1,0,2,0,0,2,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,2,0,3,0,0,0,0,0,0,1,0,0,1,1,0,1,0,0,0,0,1,1,2,1,1,0,0,0,0,1,0,0,0,0,0,1,0,1,0,2,0,1,0,0,1,0,0,3,0,1,1,0,0,1,0,0,0,3,1,2,1,1,0,1,0,0,0,0,0,1,1,6,1,2,1,1,1,1,0,2,1,1,0,3,6,1,1,0,0,0,1,0,0,3,1,2,0,2,2,1,2,1,0,0,1,2,2,5,2,2,0,2,2,0,0,0,1,1,1,5,0,0,1,0,1,0,0,3,5,2,0,1,4,0,5,0,0,0,0,1,0,3,1,3,2,3,0,1,0,2,0,0,1,7,3,5,1,2,3,2,0,0,0,1,0,1,1,0,0,1,1,0,0,0,0,0,0,1,0,0,1,2,1,3,1,0,0,0,0,0,2,1,1,1,1,0,0,1,0,0,1,2,0,0,4,1,0,0,0,0,0,0,0,2,1,0,0,0,1,0,0,3,0,1,2,1,1,0,0,0,2,0,0,1,1,0,1,0,1,1,0,0,0,0,0,2,1,0,1,1,5,0,0,0,1,0,0,1,0,2,1,2,4,2,9,4,2,5,2,0,1,1,1,1,1,0,0,1,1,1,2,1,2,3,17,7,8,3,6,4,1,4,4,1,2,2,5,5,2,4,8,5,3,2,0,4,4,3,20,20,19,45,32,33,28,19,16,13,10,8,11,5,9,17,11,4,7,2,3,4,6,7,5,8,16,10,18,15,15,11,7,8,3,14,21,20,14,15,11,17,14,14,15,9,10,11,27,18,19,15,16,10,16,9,6,16,11,12,13,7,11,20,19,15,22,9,10,9,11,20,8,14,14,13,12,21,9,12,6,2,1,0,3,4,2,6,5,4,6,0,2,0,3,2,0,4,5,2,3,3,2,1,0,1,3,1,6,4,3,7,6,6,8,7,2,1,4,5,4,14,8,10,3,8,3,2,0,8,4,8,6,5,6,4,11,10,9,6,6,2,5,8,5,8,11,12,7,10,11,3,5,2,1,1,1,1,5,1,9,3,2,3,1,0,3,0,1,2,5,3,0,3,2,1,0,0,3,0,0,2,6,5,1,1,8,4,3,2,1,3,1,2,4,5,5,1,5,3,2,1,4,0,4,6,10,2,7,4,1,1,1,5,5,1,3,3,4,1,5,8,0,3,2,8,4,4,4,7,11,10,7,12,3,3,7,1,0,3,3,11,9,8,6,7,6,5,3,8,4,6,3,10,13,5,16,13,16,6,9,10,3,9,14,11,8,7,10,12,3,7,5,4,13,13,10,17,12,15,11,14,6,10,8,14,17,10,4,19,27,12,8,4,6,3,5,4,2,3,9,13,6,14,13,20,11,12,10,3,2,3,6,16,38,18,14,9,12,6,4,4,5,7,14,9,12,13,16,11,13,8,7,3,5,12,13,11,14,11,9,11,10,8,6,14,5,3,11,7,16,19,14,8,6,8,8,8,5,16,7,15,16,13,24,28,12,9,3,2,4,3,1,8,3,0,4,4,5,6,0,7,3,13,6,10,7,15,3,2,5,5,3,5,3,7,11,11,12,5,8,6,4,4,5,4,2,4,1,18,9,22,14,4,10,8,9,5,10,7,8,14,16,15,14,10,14,0,5,9,9,16,19,23,19,25,22,20,12,6,1,2,2,1,3,1,1,1,0,4,1,1,3,1,2,2,1,4,0,2,2,6,1,6,3,2,3,5,5,4,2,16,8,5,5,5,6,16,4,3,6,6,8,23,18,14,11,8,9,8,5,6,21,12,16,16,17,13,13,7,6,10,4,16,8,12,17,26,14,7,13,9,3,14,13,11,12,12,12,23,28,14,14,16,9,15,13,12,7,15,18,17,35,17,17,16,14,17,16,39,31,27,41,42,20,23,38,17,17,20,18,13,12,27,26,22,29,20,20,16,17,11,14,23,18,19,30,33,40,50,17,21,20,18,28,14,19,30,26,20,31,28,16,17,10,3,3,2,2,9,9,3,11,7,1,6,9,6,5,4,4,5,3,5,5,3,5,1,1,2,3,2,2,5,7,4,10,5,14,6,4,4,6,2,10,11,7,11,24,12,3,2,5,4,2,2,8,10,9,20,13,7,21,26,6,7,6,5,4,14,12,11,19,6,11,2,2,1,2,3,2,2,1,6,9,13,4,4,3,2,8,9,2,11,11,13,3,8,7,3,8,6,4,10,13,11,10,20,6,2,10,10,2,3,5,10,5,11,15,23,14,3,5,7,3,5,6,5,5,8,12,8,18,6,6,3,1,3,8,13,8,11,31,11,24,18,13,3,3,21,20,23,12,12,24,30,38,17,14,9,8,7,13,10,14,27,19,34,29,18,37,12,14,20,18,37,36,38,56,38,39,31,51,31,23,32,38,42,42,39,50,49,65,56,42,39,31,62,35,65,59,53,75,55,62,52,36,31,25,36,58,41,67,68,55,94,96,56,51,51,13,0,0,2,1,0,1,0,0,1,0,0,0,1,1,0,0,0,0,3,0,1,4,0,0,0,1,0,0,0,2,1,2,1,0,0,0,0,1,0,0,2,0,3,2,0,0,1,0,0,1,0,0,3,0,2,2,1,2,1,0,3,3,1,1,2,0,4,0,1,1,0,0,5,3,6,2,0,1,6,3,3,2,1,1,0,1,4,3,3,3,9,3,0,2,1,5,3,0,5,3,6,6,5,7,3,5,5,0,0,3,2,5,10,3,5,1,3,1,6,2,2,5,5,7,4,4,3,2,3,2,4,1,4,4,1,6,5,6,4,11,5,2,0,0,3,0,0,3,1,6,4,5,3,6,2,2,2,2,3,2,2,1,2,2,4,3,4,1,1,2,4,6,5,5,2,4,3,2,0,0,0,1,1,2,4,4,4,5,7,1,0,2,1,1,3,0,4,2,7,0,4,0,5,1,0,0,5,2,2,2,2,6,8,2,2,2,1,2,0,1,2,2,2,8,0,0,0,1,2,0,2,0,4,3,6,9,6,3,8,2,1,4,0,1,2,4,7,4,3,2,1,0,0,2,7,4,2,5,3,4,1,4,2,0,0,0,1,4,7,4,4,4,3,1,2,4,3,3,4,6,0,5,7,2,5,1,1,1,0,0,1,0,1,0,0,5,4,2,1,1,2,0,0,0,1,0,2,2,0,0,0,0,0,1,1,0,2,1,0,0,0,1,3,0,0,0,1,0,1,2,0,2,1,0,1,0,0,0,0,2,1,3,3,3,2,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,0,1,2,2,4,3,3,1,1,3,1,0,3,1,0,0,0,4,4,1,1,1,0,1,1,0,1,1,0,4,7,3,4,5,13,3,4,2,3,4,7,6,8,5,4,5,2,3,1,2,10,1,2,4,4,2,3,3,1,1,2,3,1,6,5,4,5,20,10,3,4,2,3,6,0,3,21,15,9,6,21,5,9,0,2,5,6,5,14,3,13,13,6,6,4,4,2,0,2,3,4,8,13,4,5,5,1,4,4,2,7,4,4,8,6,6,11,4,4,5,7,4,0,1,7,6,9,4,9,4,8,1,6,6,3,3,6,4,4,2,14,3,4,2,0,5,3,1,3,2,2,9,5,2,1,4,6,4,1,1,3,3,2,4,2,1,2,0,3,2,3,0,2,3,6,2,5,8,1,5,0,4,3,8,7,6,7,6,6,5,0,5,6,3,3,3,5,6,6,4,6,2,1,3,3,0,2,2,3,6,4,6,2,1,2,0,6,5,8,7,7,7,8,5,4,5,0,2,2,1,1,1,4,5,5,1,2,4,2,4,1,3,1,4,2,1,4,4,2,4,3,2,1,0,10,2,10,1,7,1,2,3,2,7,2,5,5,3,6,8,10,4,10,13,7,3,4,2,7,3,4,10,5,7,7,8,4,3,3,3,3,6,4,11,6,7,6,1,6,2,5,0,1,2,5,6,11,9,4,2,1,3,2,2,0,3,7,11,6,6,5,7,0,3,4,1,7,6,4,6,8,7,12,4,2,1,1,1,4,1,5,8,5,6,5,2,0,0,1,4,4,6,2,20,8,2,4,4,2,0,0,4,2,0,0,5,2,2,2,1,1,0,2,3,2,2,0,2,3,1,2,1,0,2,0,0,2,2,0,0,1,3,1,1,3,2,3,1,1,0,0,1,3,6,2,2,1,1,1,0,3,3,4,3,6,5,3,5,5,7,2,5,1,6,9,5,3,8,0,1,1,0,0,1,0,2,1,0,2,1,0,0,1,0,0,0,0,2,0,3,1,2,1,1,1,2,3,0,1,1,0,0,1,0,1,0,1,0,0,1,1,0,0,1,3,0,3,1,0,1,0,1,1,0,2,1,0,1,1,0,0,0,0,0,0,2,0,2,2,0,2,0,0,0,1,1,3,1,1,4,5,5,1,3,0,0,0,2,0,4,0,1,0,1,0,0,1,1,1,0,2,6,2,1,1,1,5,1,0,1,1,1,1,2,3,2,3,2,1,1,0,0,1,2,1,2,2,4,5,0,1,0,1,0,2,0,3,2,2,3,1,4,2,4,0,0,0,0,0,1,3,4,3,1,0,0,0,1,0,0,0,0,1,4,1,0,0,0,2,0,0,1,0,1,1,1,2,2,2,0,0,0,0,0,2,0,2,3,2,6,4,2,0,1,1,1,0,1,2,0,0,1,1,0,0,0,1,0,0,0,0,0,1,2,3,2,1,0,0,0,0,0,1,1,1,2,1,0,0,1,0,0,0,0,0,3,1,1,2,1,0,1,0,0,0,0,1,1,4,2,1,3,4,0,2,2,9,1,3,3,4,2,4,0,0,0,1,2,0,0,1,2,2,0,1,1,0,0,0,0,0,0,0,2,2,0,2,3,0,0,1,1,0,0,3,1,0,4,1,0,0,0,1,0,1,0,1,1,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,1,1,0,0,1,0,1,2,0,1,0,1,1,1,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,3,1,1,2,2,4,2,6,1,0,0,1,0,1,2,5,1,1,1,6,3,0,0,0,1,1,2,7,3,1,2,4,2,1,3,1,2,4,3,0,0,1,1,1,1,2,1,1,0,4,1,1,0,5,1,1,0,0,1,1,0,1,4,3,0,2,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,5,3,4,6,10,10,5,6,3,1,5,4,7,1,4,0,4,10,10,6,3,4,3,5,2,11,7,8,3,11,12,7,7,4,3,6,5,8,7,4,10,7,8,3,4,1,1,5,3,7,2,5,9,9,7,11,6,2,2,2,3,7,4,4,7,6,15,11,9,5,8,5,4,2,7,4,5,13,10,12,9,4,0,10,1,4,2,8,6,6,6,6,2,2,4,6,0,3,5,6,3,9,9,7,3,4,4,2,2,4,8,7,8,4,8,3,9,3,3,4,1,3,3,7,5,8,6,7,5,3,3,3,7,4,9,7,8,13,13,7,4,2,3,4,1,6,5,3,7,10,3,10,7,1,3,3,3,6,2,5,4,9,8,7,8,4,0,1,3,3,4,6,6,7,3,3,3,1,1,2,2,3,4,2,4,5,9,0,1,3,2,0,0,3,3,6,4,5,9,5,5,2,4,1,0,2,1,2,11,7,8,3,1,0,1,3,3,2,15,5,12,4,6,8,4,3,1,4,1,5,3,8,7,4,9,16,6,4,3,4,7,21,18,8,17,11,11,6,7,6,10,6,8,11,15,16,15,20,18,22,18,6,6,8,5,2,3,6,9,12,18,6,4,5,6,5,2,12,7,12,4,9,8,6,13,4,1,3,7,2,3,1,3,4,2,2,3,0,1,0,0,4,4,7,2,1,4,2,0,4,5,1,2,3,4,1,1,8,6,1,4,1,2,2,3,3,3,3,0,3,7,4,1,2,0,1,4,4,13,11,5,2,4,2,3,2,0,0,4,1,2,1,5,3,1,2,1,2,1,2,3,2,3,5,3,11,6,1,4,6,3,8,3,1,1,4,11,4,2,3,5,2,0,1,2,5,6,4,10,11,7,8,7,4,3,1,4,5,4,4,8,7,14,13,1,3,3,6,5,4,9,14,6,13,14,16,9,5,1,3,3,3,10,9,9,6,8,6,7,2,0,0,0,1,1,0,0,1,1,0,0,0,0,3,0,0,0,0,0,2,1,0,0,0,2,0,1,1,0,1,1,1,0,0,0,0,0,1,0,1,1,0,1,0,0,0,1,0,2,1,6,3,1,0,2,0,1,0,0,0,0,1,1,0,0,1,0,0,0,0,1,0,2,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,1,0,0,0,0,0,1,2,5,2,0,3,0,1,0,0,0,0,0,0,2,0,0,0,1,0,0,0,1,0,1,0,1,1,0,0,1,1,0,4,1,2,0,0,0,1,0,0,1,0,0,0,0,13,1,1,2,2,2,0,0,0,0,0,1,0,0,0,7,17,9,0,4,1,0,1,0,0,0,4,5,5,3,3,7,0,0,0,1,2,1,1,3,1,0,0,2,1,0,1,3,0,2,0,2,3,3,4,3,0,0,5,2,0,1,0,2,2,4,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0],"nbinsx":60,"marker":{"color":"rgba(55, 55, 55, 0.8)","line":{"color":"rgba(31,119,180,1)"}},"type":"histogram","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Rat sightings count also shows strong overdispersion: the variance
(156.4) is far greater than the mean (10.2).</p>
<pre class="r"><code>rat_stats &lt;- data.frame(
  Statistic = c(&quot;Mean of Monthly Rat Sightings&quot;, &quot;Variance of Monthly Rat Sightings&quot;),
  Value = c(mean(rat1$rat_count_zip_month), var(rat1$rat_count_zip_month))
)

kable(rat_stats)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Statistic</th>
<th align="right">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mean of Monthly Rat Sightings</td>
<td align="right">10.24938</td>
</tr>
<tr class="even">
<td align="left">Variance of Monthly Rat Sightings</td>
<td align="right">156.38244</td>
</tr>
</tbody>
</table>
</div>
<div id="nyc-restaurants-inspection-results-temporal-exploration"
class="section level2">
<h2>NYC Restaurants Inspection Results Temporal Exploration</h2>
<p>While examining the temporal trend of rat sightings, we also
investigated whether overall restaurant sanitation levels in NYC changed
over time from 2019 to 2024. To represent area-level sanitation in a
simple yet meaningful way, we calculated a proxy variable,
<code>violation_rate</code>, defined as: <span class="math display">\[
\text{violation_rate} =
\frac{\text{violation_count_zip_month}}{\text{inspection_count_zip_month}}
\]</span></p>
<p>This rate reflects the proportion of inspections that resulted in at
least one violation within each ZIP–Month unit.</p>
<p><small> <em>Note: To ensure temporal alignment with the rat sighting
dataset, the restaurant data were filtered to the same 2019–2024 period.
During data cleaning, we observed notable missingness in 2020–2021,
likely due to COVID-19 shutdowns affecting restaurant operations and
inspections. However, we retained these missing values to preserve data
integrity and because they provide important context for interpretation
and modeling.</em> </small></p>
<pre class="r"><code>rest=read_csv(&quot;./data/zip_year_month_merged.csv&quot;) |&gt;
  group_by(year, month) |&gt;
  summarise(
    total_violations = sum(violation_count_zip_month, na.rm = TRUE),
    total_inspections = sum(inspection_count_zip_month, na.rm = TRUE),
    .groups = &quot;drop&quot;
  ) |&gt;
  mutate(
    violation_rate = if_else(total_inspections &gt; 0,
                             total_violations / total_inspections,
                             NA_real_),
    month_label = factor(
      month,
      levels = 1:12,
      labels = month.abb
    )
  )</code></pre>
<div id="monthly-restaurant-violation-rate-in-nyc-20192024"
class="section level3">
<h3>Monthly Restaurant Violation Rate in NYC (2019–2024)</h3>
<p>Similarly to rat sighting trends, we examined whether overall
restaurant sanitation levels show seasonal patterns. We found that the
seasonal variation in violation rates is much <strong>less
pronounced</strong> compared to rats, and differences across years are
relatively <strong>small</strong> (excluding the pandemic-affected
months in 2020–2021, most monthly violation rates remain between 3.0 and
3.6). Violation levels in 2022–2024 appear slightly higher than
pre-pandemic years. Overall, this suggests that restaurant sanitation
conditions may be more influenced by inspection practices and regulatory
enforcement rather than environmental seasonality.</p>
<pre class="r"><code>plot_ly(
  rest,
  x = ~month_label,
  y = ~violation_rate,
  color = ~factor(year),
  type = &#39;scatter&#39;,
  mode = &#39;lines+markers&#39;
) |&gt;
  layout(
    xaxis = list(title = &quot;Month&quot;),
    yaxis = list(title = &quot;Violation Rate&quot;)
  )</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-a336cfcb03cd91a4ac6a" style="width:90%;height:345.6px;"></div>
<script type="application/json" data-for="htmlwidget-a336cfcb03cd91a4ac6a">{"x":{"visdat":{"1312748ca396e":["function () ","plotlyVisDat"]},"cur_data":"1312748ca396e","attrs":{"1312748ca396e":{"x":{},"y":{},"mode":"lines+markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Month","type":"category","categoryorder":"array","categoryarray":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Violation Rate"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[4.666666666666667,2.8571428571428572,2.5428571428571427,2.6666666666666665,2.7777777777777777,2.5333333333333332,3.5,3.3500000000000001,2.7058823529411766,3.5625,2.3846153846153846,1.7894736842105263],"mode":"lines+markers","type":"scatter","name":"2019","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar"],"y":[3.52,3.3050847457627119,3.6818181818181817],"mode":"lines+markers","type":"scatter","name":"2020","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[1,1,1,1,1,2.7235772357723578,2.9645390070921986,3.46218487394958,3.6785714285714284,3.3294117647058825,3.3444976076555024],"mode":"lines+markers","type":"scatter","name":"2021","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[3.1717687074829932,2.8903903903903903,3.0666041275797373,3.254345837145471,3.4088888888888889,3.6468172484599588,3.5848513902205177,3.5379202501954654,3.4330708661417324,3.36327868852459,3.3857677902621721,3.4101738570508693],"mode":"lines+markers","type":"scatter","name":"2022","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[3.4594739667203434,3.512290502793296,3.2857142857142856,3.2778042959427207,3.2475336322869954,3.1985688729874777,3.7607105538140022,3.6214559386973182,3.4774688398849474,3.4022824536376604,3.4180522565320666,3.5325144508670521],"mode":"lines+markers","type":"scatter","name":"2023","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"line":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[3.5874524714828899,3.4295628036086052,3.2949676133532635,3.3267031327697665,3.463111111111111,3.6408060453400504,3.6358500256805342,3.6995798319327733,3.6853291861067912,3.6289184952978055,3.6029489204844656,3.5579379562043796],"mode":"lines+markers","type":"scatter","name":"2024","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"line":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>In summary, the temporal analysis offers meaningful guidance
for our modeling strategy:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Rat sighting activity fluctuates much more noticeably over time
compared to restaurant violation rates. This suggests that rats are
strongly influenced by environmental and seasonal conditions, while
restaurant sanitation is likely just one part of a broader set of
contributing factors. Future work may benefit from exploring additional
environmental variables.</p></li>
<li><p>Time clearly plays an important role. Including
<strong>Month</strong> and <strong>Year</strong> as fixed effects will
help capture both seasonal patterns and year-to-year changes (such as
the pandemic dip), leading to more reliable estimates of the
relationship between restaurant-related risks and rat activity.</p></li>
</ol>
</div>
</div>
</div>
<div id="what-neighborhood-factors-shape-rats-and-restaurant-sanitation"
class="section level1">
<h1>What Neighborhood Factors Shape Rats and Restaurant Sanitation</h1>
<p>This exploratory analysis uses the merged ZIP–year–month dataset to
examine whether three socioeconomic variables: -
<strong>poverty_rate</strong> - <strong>population_density</strong> -
<strong>median_household_income</strong></p>
<p>are associated with the outcome: -
<strong>rat_count_zip_month</strong></p>
<p>and the exposure: - <strong>violation_rate_per_inspection =
violation_count_zip_month / inspection_count_zip_month</strong></p>
<p>The goal is to determine which SES variables should be included as
covariates in the final regression model.</p>
<pre class="r"><code>dat &lt;- read_csv(&quot;data/zip_year_month_merged.csv&quot;) %&gt;%
  clean_names()</code></pre>
<pre class="r"><code>dat &lt;- dat %&gt;%
  mutate(
    violation_rate_per_inspection =
      if_else(inspection_count_zip_month &gt; 0,
              violation_count_zip_month / inspection_count_zip_month,
              NA_real_)
  )</code></pre>
<div id="how-exploring-ses-landscapes-for-rat-sighting"
class="section level2">
<h2>How Exploring SES Landscapes for Rat Sighting</h2>
<pre class="r"><code>dat %&gt;%
  select(poverty_rate, population_density, median_household_income) %&gt;%
  pivot_longer(everything(), names_to = &quot;variable&quot;, values_to = &quot;value&quot;) %&gt;%
  ggplot(aes(x = value)) +
  geom_histogram(bins = 30, alpha = 0.7) +
  facet_wrap(~ variable, scales = &quot;free&quot;) +
  theme_minimal()</code></pre>
<p><img src="report_files/figure-html/ses-distribution-1.png" width="90%" /></p>
<p>The SES variables show substantial variation across ZIP codes in New
York City. Poverty rate exhibits a right-skewed distribution, indicating
that while many ZIP codes have relatively low poverty, a considerable
number experience markedly higher poverty levels. Population density
varies dramatically across ZIP codes, reflecting known differences
between outer-borough residential zones and the densely populated core
of Manhattan. Median household income shows a long right tail, as
several ZIP codes include affluent neighborhoods with income levels far
above the citywide median. These distributions demonstrate that SES
indicators in the data contain sufficient variability to meaningfully
examine their associations with rat sightings and restaurant
violations.</p>
</div>
<div id="do-socioeconomic-conditions-align-with-rats-and-violations"
class="section level2">
<h2>Do Socioeconomic Conditions Align With Rats and Violations</h2>
<pre class="r"><code>corr_data &lt;- dat %&gt;%
  select(
    rat_count_zip_month,
    violation_rate_per_inspection,
    poverty_rate,
    population_density,
    median_household_income
  )

cor_matrix &lt;- cor(corr_data, use = &quot;pairwise.complete.obs&quot;)

cor_table &lt;- cor_matrix %&gt;%
  round(2) %&gt;%
  as.data.frame() %&gt;%
  tibble::rownames_to_column(&quot;Variable&quot;)

nice_names &lt;- c(
  &quot;Variable&quot;,
  &quot;Rat count / month&quot;,
  &quot;Violations / inspection&quot;,
  &quot;Poverty rate&quot;,
  &quot;Population density&quot;,
  &quot;Median HH income&quot;
)</code></pre>
<pre class="r"><code>cor_table %&gt;%
  kable(
    caption = &quot;Correlation matrix for rat counts, violation rates, and SES variables&quot;,
    col.names = nice_names,
    align = &quot;lrrrrr&quot;
  ) %&gt;%
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;),
    font_size = 12,
    position = &quot;center&quot;
  ) %&gt;%
  scroll_box(width = &quot;100%&quot;, height = &quot;300px&quot;)</code></pre>
<div
style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Correlation matrix for rat counts, violation rates, and SES variables
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Rat count / month
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Violations / inspection
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Poverty rate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Population density
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Median HH income
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
rat_count_zip_month
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
-0.21
</td>
</tr>
<tr>
<td style="text-align:left;">
violation_rate_per_inspection
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
poverty_rate
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
-0.75
</td>
</tr>
<tr>
<td style="text-align:left;">
population_density
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
-0.46
</td>
</tr>
<tr>
<td style="text-align:left;">
median_household_income
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.75
</td>
<td style="text-align:right;">
-0.46
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
</tbody>
</table>
</div>
<p>Correlation analysis reveals meaningful relationships between SES
variables and both the outcome and exposure. Rat sightings are
positively correlated with poverty rate and population density,
suggesting that poorer or more crowded neighborhoods tend to report more
rat activity. Median household income is slightly negatively correlated
with rat sightings, implying that wealthier ZIP codes generally
experience fewer rat complaints.</p>
<p>Population density exhibits the strongest positive correlation with
restaurant violation rates, indicating that dense neighborhoods are more
likely to have sanitation issues reflected in inspection outcomes.
Poverty rate has a weak positive relationship with the violation rate,
while median household income shows a weak negative association with
violations.</p>
<p>The SES variables are also correlated with each other. Poverty rate
and median household income display a strong negative correlation, while
population density is moderately positively correlated with poverty
rate. These relationships highlight potential multicollinearity concerns
if certain SES variables are included together in later multivariable
models.</p>
</div>
<div id="ses-vs-outcome-rat-count" class="section level2">
<h2>SES vs Outcome: Rat Count</h2>
<p>Who Gets the Rats? SES Gradients in Rodent Activity</p>
<pre class="r"><code>ggplot(dat, aes(x = poverty_rate, y = rat_count_zip_month)) +
  geom_point(alpha = 0.4) +
  geom_smooth(method = &quot;lm&quot;) +
  theme_minimal() +
  labs(title = &quot;Rat Count vs Poverty Rate&quot;)</code></pre>
<p><img src="report_files/figure-html/ses-vs-rats-1.png" width="90%" /></p>
<pre class="r"><code>ggplot(dat, aes(x = population_density, y = rat_count_zip_month)) +
  geom_point(alpha = 0.4) +
  geom_smooth(method = &quot;lm&quot;) +
  theme_minimal() +
  labs(title = &quot;Rat Count vs Population Density&quot;)</code></pre>
<p><img src="report_files/figure-html/ses-vs-rats-2.png" width="90%" /></p>
<pre class="r"><code>ggplot(dat, aes(x = median_household_income, y = rat_count_zip_month)) +
  geom_point(alpha = 0.4) +
  geom_smooth(method = &quot;lm&quot;) +
  theme_minimal() +
  labs(title = &quot;Rat Count vs Median Household Income&quot;)</code></pre>
<p><img src="report_files/figure-html/ses-vs-rats-3.png" width="90%" /></p>
<p>Each of the SES variables demonstrates a distinct association with
rat sighting activity. ZIP codes with higher poverty rates consistently
show higher rat sighting counts, which may reflect reduced
infrastructure quality, fewer resources for pest control, and greater
environmental stress. Population density is also positively associated
with rat sightings, likely because denser regions generate greater waste
and offer more food sources and nesting sites for rodents. Median
household income displays a negative association with rat sightings;
higher-income neighborhoods report fewer rat incidents, which may
reflect better building maintenance, improved sanitation, and greater
access to pest management services.</p>
</div>
<div id="ses-vs-exposure-violation-rate-per-inspection"
class="section level2">
<h2>SES vs Exposure: Violation Rate per Inspection</h2>
<p>Which Neighborhoods Struggle With Restaurant Sanitation?</p>
<pre class="r"><code>ggplot(dat, aes(x = poverty_rate, y = violation_rate_per_inspection)) +
  geom_point(alpha = 0.4) +
  geom_smooth(method = &quot;lm&quot;) +
  theme_minimal() +
  labs(title = &quot;Violation Rate per Inspection vs Poverty Rate&quot;)</code></pre>
<p><img src="report_files/figure-html/ses-vs-exposure-1.png" width="90%" /></p>
<pre class="r"><code>ggplot(dat, aes(x = population_density, y = violation_rate_per_inspection)) +
  geom_point(alpha = 0.4) +
  geom_smooth(method = &quot;lm&quot;) +
  theme_minimal() +
  labs(title = &quot;Violation Rate per Inspection vs Population Density&quot;)</code></pre>
<p><img src="report_files/figure-html/ses-vs-exposure-2.png" width="90%" /></p>
<pre class="r"><code>ggplot(dat, aes(x = median_household_income, y = violation_rate_per_inspection)) +
  geom_point(alpha = 0.4) +
  geom_smooth(method = &quot;lm&quot;) +
  theme_minimal() +
  labs(title = &quot;Violation Rate per Inspection vs Median Household Income&quot;)</code></pre>
<p><img src="report_files/figure-html/ses-vs-exposure-3.png" width="90%" />
Population density is the SES indicator most strongly associated with
the violation rate per inspection. ZIP codes with higher density tend to
have higher restaurant violation rates, possibly because dense areas
contain more restaurants, higher foot traffic, and environmental
pressures that challenge sanitation practices. Poverty rate shows a mild
positive trend with violation rates, while median household income shows
a mild negative relationship, consistent with socioeconomic patterns
observed in the rat sighting analysis.</p>
</div>
<div id="ses-predictors-that-truly-matter" class="section level2">
<h2>SES Predictors That Truly Matter</h2>
<p>This exploratory analysis demonstrates that poverty rate and
population density are the two socioeconomic indicators most strongly
and consistently associated with both monthly rat sighting counts and
the violation rate per restaurant inspection across New York City ZIP
codes from 2019 to 2024. ZIP codes with higher poverty or greater
population density tend to exhibit more rat activity and higher
restaurant violation burdens, highlighting these SES factors as
important structural characteristics relevant to environmental
conditions and sanitation outcomes.</p>
<p>Given their clear relationships with both the outcome and exposure,
and their conceptual relevance as neighborhood-level socioeconomic
determinants, poverty rate and population density should be included as
key covariates in the final regression model. In contrast, median
household income should not be included jointly with poverty rate, as
the two measures are strongly negatively correlated and would likely
introduce multicollinearity, reducing the stability and interpretability
of model estimates.</p>
<pre class="r"><code>library(tidyverse)
library(readr)
library(janitor)
library(dplyr)
library(ggplot2)
library(readxl)
library(sf)
library(spdep)
library(tigris)
library(lubridate)
library(MASS)
library(broom)
library(knitr)</code></pre>
</div>
<div id="model-objective" class="section level2">
<h2>Model Objective</h2>
<p>We used statistical modeling to examine whether changes in restaurant
sanitation conditions are associated with rat sighting over time at the
ZIP–month level across New York City.</p>
<p>H0 (null hypothesis): There is no association between violation rate
and rat sighting counts at the ZIP–month level. <span
class="math display">\[
H_0: \beta_1 = 0 \;\Rightarrow\; IRR = 1
\]</span></p>
<p>H1 (alternative hypothesis): Higher violation rates are associated
with higher rat sighting counts. <span class="math display">\[
H_1: \beta_1 &gt; 0 \;\Rightarrow\; IRR &gt; 1
\]</span></p>
</div>
<div id="outcome-and-predictors" class="section level2">
<h2>Outcome and Predictors</h2>
<p><strong>Outcome</strong> <code>rat_count_zip_month</code>: monthly
rat sighting count per ZIP code</p>
<p><strong>Main Exposure</strong>: <code>violation_rate</code>: proxy
variable in our model to represent restaurant sanitation in zip level,
so we created this ratio of violation to inspections within each ZIP
code and year-month. <span class="math display">\[
\text{violation_rate} =
\frac{\text{violation_count_zip_month}}{\text{inspection_count_zip_month}}
\]</span> <strong>Covariates</strong>: <code>population_density</code>
and <code>poverty_rate</code>.</p>
<p><strong>Time controls</strong>: <code>year</code> and
<code>month</code> included as categorical fixed effects to account for
seasonal and long-term trends.</p>
</div>
<div id="model-selection" class="section level2">
<h2>Model Selection</h2>
<p>In Temporal Analysis from our EDA, we found that
<code>rat_count_zip_month</code> exhibit substantial overdispersion
(variance &gt;&gt; mean), we used Negative Binomial Regression rather
than Poisson regression. Negative binomial regression estimates how
predictors influence count events, especially when the data are more
variable than expected under a Poisson model.</p>
<pre class="r"><code>df_merged=read_csv(&quot;./data/zip_year_month_merged.csv&quot;) 

df_model &lt;- df_merged |&gt;
  # calculate violation rate
  mutate(
    violation_rate = violation_count_zip_month / inspection_count_zip_month,
    violation_rate = ifelse(is.na(violation_rate) |
                            inspection_count_zip_month == 0, 0, violation_rate)
  ) |&gt;

  group_by(zipcode) |&gt;
  arrange(zipcode, year, month) |&gt;
  mutate(
    lag_violation_rate = lag(violation_rate, 1)
  ) |&gt;
  ungroup() |&gt;

  filter(!is.na(lag_violation_rate))</code></pre>
</div>
<div id="model-building-and-comparison" class="section level2">
<h2>Model Building and Comparison</h2>
<p>We estimated four nested negative binomial regression models to
progressively evaluate the contribution of sanitation, socioeconomic,
and temporal factors.</p>
<div id="model-1---unadjusted-model-major-effect"
class="section level3">
<h3>Model 1 - unadjusted model (major effect)</h3>
<p>Only restaurant sanitation (current month violation rate) <span
class="math display">\[
\log \left(E[Y_{z,t}]\right) =
\beta_0 +
\beta_1 \cdot \text{violation_rate}_{z,t}
\]</span></p>
<pre class="r"><code>model1 &lt;- glm.nb(
  rat_count_zip_month ~ 
    violation_rate,
  data = df_model)

model1_results &lt;- tidy(model1, exponentiate = TRUE, conf.int = TRUE) |&gt;
  mutate(
    estimate = round(estimate, 3),
    conf.low = round(conf.low, 3),
    conf.high = round(conf.high, 3),
    p.value = ifelse(p.value &lt; 0.05, &quot;&lt;0.05***&quot;, round(p.value, 3))
  ) |&gt;
  rename(
    term = term,
    IRR = estimate,
    `2.5% CI` = conf.low,
    `97.5% CI` = conf.high,
    p.value = p.value
  )

kable(model1_results)</code></pre>
<table>
<colgroup>
<col width="22%" />
<col width="8%" />
<col width="14%" />
<col width="14%" />
<col width="13%" />
<col width="11%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">IRR</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="left">p.value</th>
<th align="right">2.5% CI</th>
<th align="right">97.5% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">8.060</td>
<td align="right">0.0145260</td>
<td align="right">143.67164</td>
<td align="left">&lt;0.05***</td>
<td align="right">7.830</td>
<td align="right">8.300</td>
</tr>
<tr class="even">
<td align="left">violation_rate</td>
<td align="right">1.134</td>
<td align="right">0.0055727</td>
<td align="right">22.60395</td>
<td align="left">&lt;0.05***</td>
<td align="right">1.121</td>
<td align="right">1.147</td>
</tr>
</tbody>
</table>
<pre class="r"><code>new_df &lt;- data.frame(
  violation_rate = seq(
    min(df_model$violation_rate),
    max(df_model$violation_rate),
    length.out = 100)
)

pred &lt;- predict(model1, newdata = new_df,
                type = &quot;response&quot;, se.fit = TRUE)

new_df &lt;- new_df |&gt; 
  mutate(
    fit = pred$fit,
    lower = fit - 1.96 * pred$se.fit,
    upper = fit + 1.96 * pred$se.fit
  )

ggplot(new_df, aes(x = violation_rate, y = fit)) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.2) +
  labs(
    title = &quot;Predicted Rat Sightings by Violation Rate&quot;,
    x = &quot;Restaurant Violation Rate&quot;,
    y = &quot;Predicted Rat Sightings (per ZIP per Month)&quot;
  ) +
  theme_minimal()</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-24-1.png" width="90%" /></p>
<p>In Model 1, the incidence rate ratio (IRR) for violation rate is
1.134 (95% CI: 1.121–1.147, p &lt; 0.001), which means that at 5%
significant level, every 1-unit in <code>violation_rate</code>
increasing, rat sightings increase by 13.4% on average.</p>
<p>Higher restaurant violation rates are associated with substantial
increases in rat sightings, indicating that deteriorating sanitation
environments may contribute to rat infestations. However, Model 1 does
not control for other covariates, and may not overestimate the
associaiton.</p>
</div>
<div id="model-2---ses---adjusted" class="section level3">
<h3>Model 2 - SES - Adjusted</h3>
<p>Adding SES predictors <span class="math display">\[
\log \left(E[Y_{z,t}]\right)
=
\beta_0
+ \beta_1 \cdot \text{violation_rate}_{z,t}
+ \beta_2 \cdot \text{population_density}_{z}
+ \beta_3 \cdot \text{poverty_rate}_{z}
\]</span></p>
<pre class="r"><code>model2 &lt;- glm.nb(
  rat_count_zip_month ~ 
    violation_rate+
    population_density +
    poverty_rate,
  data = df_model)

model2_results &lt;- tidy(model2, exponentiate = TRUE, conf.int = TRUE) |&gt;
  mutate(
    estimate = round(estimate, 3),
    conf.low = round(conf.low, 3),
    conf.high = round(conf.high, 3),
    p.value = ifelse(p.value &lt; 0.001, &quot;&lt;0.001***&quot;, round(p.value, 3))
  ) |&gt;
  rename(
    term = term,
    IRR = estimate,
    `2.5% CI` = conf.low,
    `97.5% CI` = conf.high,
    p.value = p.value
  )

kable(model2_results)</code></pre>
<table>
<colgroup>
<col width="26%" />
<col width="8%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="11%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">IRR</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="left">p.value</th>
<th align="right">2.5% CI</th>
<th align="right">97.5% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.402</td>
<td align="right">0.0223067</td>
<td align="right">15.15695</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.335</td>
<td align="right">1.473</td>
</tr>
<tr class="even">
<td align="left">violation_rate</td>
<td align="right">1.108</td>
<td align="right">0.0046819</td>
<td align="right">21.97650</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.098</td>
<td align="right">1.119</td>
</tr>
<tr class="odd">
<td align="left">population_density</td>
<td align="right">1.026</td>
<td align="right">0.0003544</td>
<td align="right">73.20820</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.025</td>
<td align="right">1.027</td>
</tr>
<tr class="even">
<td align="left">poverty_rate</td>
<td align="right">7.893</td>
<td align="right">0.0893442</td>
<td align="right">23.12423</td>
<td align="left">&lt;0.001***</td>
<td align="right">6.500</td>
<td align="right">9.596</td>
</tr>
</tbody>
</table>
<pre class="r"><code>new_df2 &lt;- data.frame(
  violation_rate = seq(
    min(df_model$violation_rate),
    max(df_model$violation_rate),
    length.out = 100
  ),
  population_density = mean(df_model$population_density, na.rm = TRUE),
  poverty_rate = mean(df_model$poverty_rate, na.rm = TRUE)
)

pred2 &lt;- predict(model2, newdata = new_df2, 
                 type = &quot;response&quot;, se.fit = TRUE)

new_df2 &lt;- new_df2 |&gt;
  mutate(
    fit = pred2$fit,
    lower = fit - 1.96 * pred2$se.fit,
    upper = fit + 1.96 * pred2$se.fit
  )

ggplot(new_df2, aes(x = violation_rate, y = fit)) +
  geom_line(size = 1.1) +
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.2) +
  labs(
    title = &quot;Adjusted Predicted Rat Sightings by Restaurant Violation Rate&quot;,
    subtitle = &quot;Model adjusted for population density and poverty rate&quot;,
    x = &quot;Restaurant Violation Rate&quot;,
    y = &quot;Predicted Rat Sightings&quot;
  ) +
  theme_minimal()</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-26-1.png" width="90%" /></p>
<p>In Model 2, the incidence rate ratio (IRR) for violation rate
decreased (1.108) (95% CI: 1.098–1.119, p &lt; 0.001), which means that
at 5% significant level, every 1-unit in <code>violation_rate</code>
increasing, rat sightings increase by 11.08% on average, adjusted by
<code>population_density</code> and <code>poverty_rate</code>.</p>
<p>We can also notice that the incidence rate ratio (IRR) for population
density is 1.026 (95% CI: 1.025–1.027, p &lt; 0.001) and for poverty
rate is 7.893 (95% CI: 6.5–9.596, p &lt; 0.001), and both of them are
statistically significant, indicating although restaurant violation rate
is significant, but SES variables also had impact on rat sightings.</p>
</div>
<div id="model-3---time-controls---fully-adjusted"
class="section level3">
<h3>Model 3 - Time Controls - Fully Adjusted</h3>
<p>Adding Time Controls (<code>year</code>2019 and <code>month</code>1
are the reference levels)</p>
<p><span class="math display">\[
\log \left(E[Y_{z,t}]\right)
=
\beta_0
+ \beta_1 \cdot \text{violation_rate}_{z,t}
+ \beta_2 \cdot \text{population_density}_{z}
+ \beta_3 \cdot \text{poverty_rate}_{z}
+ \gamma_t(\text{month})
+ \delta_t(\text{year})
\]</span></p>
<pre class="r"><code>model3 &lt;- glm.nb(
  rat_count_zip_month ~ 
    violation_rate+
    population_density +
    poverty_rate+
    factor(year) +
    factor(month),
  data = df_model)

model3_results &lt;- tidy(model3, exponentiate = TRUE, conf.int = TRUE) |&gt;
  mutate(
    estimate = round(estimate, 3),
    conf.low = round(conf.low, 3),
    conf.high = round(conf.high, 3),
    p.value = ifelse(p.value &lt; 0.001, &quot;&lt;0.001***&quot;, round(p.value, 3))
  ) |&gt;
  rename(
    term = term,
    IRR = estimate,
    `2.5% CI` = conf.low,
    `97.5% CI` = conf.high,
    p.value = p.value
  )

kable(model3_results)</code></pre>
<table>
<colgroup>
<col width="26%" />
<col width="8%" />
<col width="13%" />
<col width="15%" />
<col width="13%" />
<col width="10%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">IRR</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="left">p.value</th>
<th align="right">2.5% CI</th>
<th align="right">97.5% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.923</td>
<td align="right">0.0452040</td>
<td align="right">-1.7689280</td>
<td align="left">0.077</td>
<td align="right">0.843</td>
<td align="right">1.011</td>
</tr>
<tr class="even">
<td align="left">violation_rate</td>
<td align="right">1.086</td>
<td align="right">0.0066114</td>
<td align="right">12.4920533</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.071</td>
<td align="right">1.102</td>
</tr>
<tr class="odd">
<td align="left">population_density</td>
<td align="right">1.026</td>
<td align="right">0.0003444</td>
<td align="right">75.5556450</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.026</td>
<td align="right">1.027</td>
</tr>
<tr class="even">
<td align="left">poverty_rate</td>
<td align="right">8.011</td>
<td align="right">0.0859835</td>
<td align="right">24.2000466</td>
<td align="left">&lt;0.001***</td>
<td align="right">6.647</td>
<td align="right">9.664</td>
</tr>
<tr class="odd">
<td align="left">factor(year)2020</td>
<td align="right">0.994</td>
<td align="right">0.0310548</td>
<td align="right">-0.2074888</td>
<td align="left">0.836</td>
<td align="right">0.935</td>
<td align="right">1.056</td>
</tr>
<tr class="even">
<td align="left">factor(year)2021</td>
<td align="right">1.419</td>
<td align="right">0.0307259</td>
<td align="right">11.3998243</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.337</td>
<td align="right">1.507</td>
</tr>
<tr class="odd">
<td align="left">factor(year)2022</td>
<td align="right">1.258</td>
<td align="right">0.0353234</td>
<td align="right">6.4957191</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.171</td>
<td align="right">1.351</td>
</tr>
<tr class="even">
<td align="left">factor(year)2023</td>
<td align="right">1.241</td>
<td align="right">0.0359272</td>
<td align="right">6.0178904</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.154</td>
<td align="right">1.335</td>
</tr>
<tr class="odd">
<td align="left">factor(year)2024</td>
<td align="right">1.178</td>
<td align="right">0.0365402</td>
<td align="right">4.4843757</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.094</td>
<td align="right">1.269</td>
</tr>
<tr class="even">
<td align="left">factor(month)2</td>
<td align="right">0.917</td>
<td align="right">0.0450035</td>
<td align="right">-1.9365285</td>
<td align="left">0.053</td>
<td align="right">0.840</td>
<td align="right">1.000</td>
</tr>
<tr class="odd">
<td align="left">factor(month)3</td>
<td align="right">1.153</td>
<td align="right">0.0445686</td>
<td align="right">3.1948529</td>
<td align="left">0.001</td>
<td align="right">1.057</td>
<td align="right">1.258</td>
</tr>
<tr class="even">
<td align="left">factor(month)4</td>
<td align="right">1.306</td>
<td align="right">0.0443632</td>
<td align="right">6.0162877</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.198</td>
<td align="right">1.424</td>
</tr>
<tr class="odd">
<td align="left">factor(month)5</td>
<td align="right">1.621</td>
<td align="right">0.0440625</td>
<td align="right">10.9595427</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.487</td>
<td align="right">1.766</td>
</tr>
<tr class="even">
<td align="left">factor(month)6</td>
<td align="right">1.670</td>
<td align="right">0.0440264</td>
<td align="right">11.6521969</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.533</td>
<td align="right">1.820</td>
</tr>
<tr class="odd">
<td align="left">factor(month)7</td>
<td align="right">1.724</td>
<td align="right">0.0440184</td>
<td align="right">12.3767753</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.582</td>
<td align="right">1.879</td>
</tr>
<tr class="even">
<td align="left">factor(month)8</td>
<td align="right">1.722</td>
<td align="right">0.0440481</td>
<td align="right">12.3351748</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.580</td>
<td align="right">1.876</td>
</tr>
<tr class="odd">
<td align="left">factor(month)9</td>
<td align="right">1.526</td>
<td align="right">0.0441635</td>
<td align="right">9.5654902</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.400</td>
<td align="right">1.663</td>
</tr>
<tr class="even">
<td align="left">factor(month)10</td>
<td align="right">1.368</td>
<td align="right">0.0443199</td>
<td align="right">7.0744034</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.255</td>
<td align="right">1.492</td>
</tr>
<tr class="odd">
<td align="left">factor(month)11</td>
<td align="right">1.012</td>
<td align="right">0.0448139</td>
<td align="right">0.2752933</td>
<td align="left">0.783</td>
<td align="right">0.928</td>
<td align="right">1.105</td>
</tr>
<tr class="even">
<td align="left">factor(month)12</td>
<td align="right">0.819</td>
<td align="right">0.0452732</td>
<td align="right">-4.4178590</td>
<td align="left">&lt;0.001***</td>
<td align="right">0.750</td>
<td align="right">0.894</td>
</tr>
</tbody>
</table>
<pre class="r"><code>new_df3 &lt;- data.frame(
  violation_rate = seq(
    min(df_model$violation_rate),
    max(df_model$violation_rate),
    length.out = 100
  ),
  population_density = mean(df_model$population_density, na.rm = TRUE),
  poverty_rate = mean(df_model$poverty_rate, na.rm = TRUE),
  year = &quot;2022&quot;,  
  month = &quot;6&quot;      
)

pred3 &lt;- predict(model3, newdata = new_df3, 
                 type = &quot;response&quot;, se.fit = TRUE)

new_df3 &lt;- new_df3 |&gt;
  mutate(
    fit = pred3$fit,
    lower = fit - 1.96 * pred3$se.fit,
    upper = fit + 1.96 * pred3$se.fit
  )

ggplot(new_df3, aes(x = violation_rate, y = fit)) +
  geom_line(size = 1.1) +
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.15) +
  labs(
    title = &quot;Fully Adjusted Model&quot;,
    subtitle = &quot;Predicted Rat Sightings by Violation Rate\nAdjusted for population density, poverty rate, year &amp; month&quot;,
    x = &quot;Restaurant Violation Rate&quot;,
    y = &quot;Predicted Rat Sightings&quot;
  ) +
  theme_minimal()</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-28-1.png" width="90%" /></p>
<p>In Model 3, the incidence rate ratio (IRR) for violation rate is
1.086 (95% CI: 1.071–1.102, p &lt; 0.001), which means that at 5%
significant level, every 1-unit in <code>violation_rate</code>
increasing, rat sightings increase by 10.71% on average, adjusted by
<code>population_density</code>, <code>poverty_rate</code>,
<code>year</code>, <code>month</code>.</p>
<p>After adjusting for <code>month</code> and <code>year</code> fixed
effects, the association between violation rate and rat sightings
remained statistically significant, though slightly attenuated (IRR ≈
1.086). Seasonality and long-term trends were evident — sightings peaked
in summer months (May–September) and showed a post-pandemic rebound —
yet restaurant violations still demonstrated an independent contribution
to rat activity.</p>
</div>
<div id="model-4---lag-violation-rate---adjusted"
class="section level3">
<h3>Model 4 - lag violation rate - Adjusted</h3>
<p>Previous month violations predict current rat activity: we also want
to take a look at the lag violation as the primary exposure to avoid
reverse causality, so we created a new variable
<code>lag_violation_rate</code>. <span class="math display">\[
\log \left(E[Y_{z,t}]\right]
=
\beta_0
+ \beta_1 \cdot \text{lag_violation_rate}_{z,t}
+ \beta_2 \cdot \text{population_density}_{z}
+ \beta_3 \cdot \text{poverty_rate}_{z}
+ \gamma_t(\text{month})
+ \delta_t(\text{year})
\]</span></p>
<pre class="r"><code>model4 &lt;- glm.nb(
  rat_count_zip_month ~ 
    lag_violation_rate+
    population_density +
    poverty_rate+
    factor(year) +
    factor(month),
  data = df_model)

model4_results &lt;- tidy(model4, exponentiate = TRUE, conf.int = TRUE) |&gt;
  mutate(
    estimate = round(estimate, 3),
    conf.low = round(conf.low, 3),
    conf.high = round(conf.high, 3),
    p.value = ifelse(p.value &lt; 0.001, &quot;&lt;0.001***&quot;, round(p.value, 3))
  ) |&gt;
  rename(
    term = term,
    IRR = estimate,
    `2.5% CI` = conf.low,
    `97.5% CI` = conf.high,
    p.value = p.value
  )

kable(model4_results)</code></pre>
<table>
<colgroup>
<col width="26%" />
<col width="8%" />
<col width="13%" />
<col width="15%" />
<col width="13%" />
<col width="10%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">IRR</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="left">p.value</th>
<th align="right">2.5% CI</th>
<th align="right">97.5% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.932</td>
<td align="right">0.0452611</td>
<td align="right">-1.5509046</td>
<td align="left">0.121</td>
<td align="right">0.851</td>
<td align="right">1.021</td>
</tr>
<tr class="even">
<td align="left">lag_violation_rate</td>
<td align="right">1.086</td>
<td align="right">0.0066534</td>
<td align="right">12.3672269</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.070</td>
<td align="right">1.102</td>
</tr>
<tr class="odd">
<td align="left">population_density</td>
<td align="right">1.026</td>
<td align="right">0.0003443</td>
<td align="right">75.5982409</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.026</td>
<td align="right">1.027</td>
</tr>
<tr class="even">
<td align="left">poverty_rate</td>
<td align="right">8.027</td>
<td align="right">0.0859992</td>
<td align="right">24.2191739</td>
<td align="left">&lt;0.001***</td>
<td align="right">6.660</td>
<td align="right">9.684</td>
</tr>
<tr class="odd">
<td align="left">factor(year)2020</td>
<td align="right">0.991</td>
<td align="right">0.0310608</td>
<td align="right">-0.2806213</td>
<td align="left">0.779</td>
<td align="right">0.933</td>
<td align="right">1.053</td>
</tr>
<tr class="even">
<td align="left">factor(year)2021</td>
<td align="right">1.440</td>
<td align="right">0.0306366</td>
<td align="right">11.8924966</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.356</td>
<td align="right">1.528</td>
</tr>
<tr class="odd">
<td align="left">factor(year)2022</td>
<td align="right">1.268</td>
<td align="right">0.0350627</td>
<td align="right">6.7648433</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.180</td>
<td align="right">1.361</td>
</tr>
<tr class="even">
<td align="left">factor(year)2023</td>
<td align="right">1.241</td>
<td align="right">0.0359818</td>
<td align="right">6.0076595</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.153</td>
<td align="right">1.336</td>
</tr>
<tr class="odd">
<td align="left">factor(year)2024</td>
<td align="right">1.176</td>
<td align="right">0.0366213</td>
<td align="right">4.4298133</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.091</td>
<td align="right">1.268</td>
</tr>
<tr class="even">
<td align="left">factor(month)2</td>
<td align="right">0.909</td>
<td align="right">0.0450314</td>
<td align="right">-2.1108607</td>
<td align="left">0.035</td>
<td align="right">0.833</td>
<td align="right">0.993</td>
</tr>
<tr class="odd">
<td align="left">factor(month)3</td>
<td align="right">1.141</td>
<td align="right">0.0446001</td>
<td align="right">2.9663687</td>
<td align="left">0.003</td>
<td align="right">1.046</td>
<td align="right">1.245</td>
</tr>
<tr class="even">
<td align="left">factor(month)4</td>
<td align="right">1.283</td>
<td align="right">0.0444078</td>
<td align="right">5.6117528</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.176</td>
<td align="right">1.399</td>
</tr>
<tr class="odd">
<td align="left">factor(month)5</td>
<td align="right">1.605</td>
<td align="right">0.0440858</td>
<td align="right">10.7273401</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.472</td>
<td align="right">1.749</td>
</tr>
<tr class="even">
<td align="left">factor(month)6</td>
<td align="right">1.655</td>
<td align="right">0.0440544</td>
<td align="right">11.4350093</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.518</td>
<td align="right">1.803</td>
</tr>
<tr class="odd">
<td align="left">factor(month)7</td>
<td align="right">1.735</td>
<td align="right">0.0440192</td>
<td align="right">12.5169380</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.592</td>
<td align="right">1.890</td>
</tr>
<tr class="even">
<td align="left">factor(month)8</td>
<td align="right">1.707</td>
<td align="right">0.0441016</td>
<td align="right">12.1225739</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.566</td>
<td align="right">1.860</td>
</tr>
<tr class="odd">
<td align="left">factor(month)9</td>
<td align="right">1.488</td>
<td align="right">0.0443205</td>
<td align="right">8.9641349</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.364</td>
<td align="right">1.622</td>
</tr>
<tr class="even">
<td align="left">factor(month)10</td>
<td align="right">1.362</td>
<td align="right">0.0443827</td>
<td align="right">6.9609778</td>
<td align="left">&lt;0.001***</td>
<td align="right">1.249</td>
<td align="right">1.485</td>
</tr>
<tr class="odd">
<td align="left">factor(month)11</td>
<td align="right">0.992</td>
<td align="right">0.0449203</td>
<td align="right">-0.1806283</td>
<td align="left">0.857</td>
<td align="right">0.909</td>
<td align="right">1.083</td>
</tr>
<tr class="even">
<td align="left">factor(month)12</td>
<td align="right">0.817</td>
<td align="right">0.0453040</td>
<td align="right">-4.4617546</td>
<td align="left">&lt;0.001***</td>
<td align="right">0.748</td>
<td align="right">0.892</td>
</tr>
</tbody>
</table>
<pre class="r"><code>new_df4 &lt;- data.frame(
  lag_violation_rate = seq(
    min(df_model$lag_violation_rate),
    max(df_model$lag_violation_rate),
    length.out = 100
  ),
  population_density = mean(df_model$population_density, na.rm = TRUE),
  poverty_rate = mean(df_model$poverty_rate, na.rm = TRUE),
  year = &quot;2022&quot;,
  month = &quot;6&quot;
)

pred4 &lt;- predict(model4, newdata = new_df4, 
                 type = &quot;response&quot;, se.fit = TRUE)

new_df4 &lt;- new_df4 |&gt;
  mutate(
    fit = pred4$fit,
    lower = fit - 1.96 * pred4$se.fit,
    upper = fit + 1.96 * pred4$se.fit
  )

ggplot(new_df4, aes(x = lag_violation_rate, y = fit)) +
  geom_line(size = 1.1) +
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.15) +
  labs(
    title = &quot;Lagged Model: Predicted Rat Sightings by Violation Rate (1-month lag)&quot;,
    subtitle = &quot;Adjusted for SES, year and month&quot;,
    x = &quot;Lagged Restaurant Violation Rate (previous month)&quot;,
    y = &quot;Predicted Rat Sightings&quot;
  ) +
  theme_minimal()</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-30-1.png" width="90%" /></p>
<p>In Model 4, the incidence rate ratio (IRR) for lag violation rate is
1.086 (95% CI: 1.070–1.102, p &lt; 0.001), which means that at 5%
significant level, every 1-unit in <code>violation_rate</code>
increasing, rat sightings increase by 10.86% on average, adjusted by
<code>population_density</code>, <code>poverty_rate</code>,
<code>year</code>, <code>month</code>.</p>
<p>Using the previous month’s violation rate to predict current rat
sightings, lagged violations remained a statistically significant
predictor, helping reduce concerns about reverse causality. This
suggests that poor sanitation has a cumulative impact — creating
environmental conditions that allow rats to persist and proliferate over
time, rather than triggering immediate effects only.</p>
</div>
</div>
<div id="model-evaluation" class="section level2">
<h2>Model Evaluation</h2>
<p>To compare predictive performance across the four negative binomial
models, we conducted 100 Monte-Carlo cross-validation repetitions. For
each split, models were trained on a random subset of ZIP-month
observations and evaluated on unseen data using Root Mean Squared Error
(RMSE).</p>
<pre class="r"><code>library(modelr)
set.seed(123)

cv_df &lt;- crossv_mc(df_model, 100) |&gt;
  mutate(
    train = map(train, as_tibble),
    test  = map(test, as_tibble)
  )</code></pre>
<pre class="r"><code>cv_df &lt;- cv_df |&gt;
  mutate(
    m1 = map(train, \(df) glm.nb(rat_count_zip_month ~ violation_rate, data = df)),
    m2 = map(train, \(df) glm.nb(rat_count_zip_month ~ violation_rate +
                                 population_density + poverty_rate, data = df)),
    m3 = map(train, \(df) glm.nb(rat_count_zip_month ~ violation_rate +
                                 population_density + poverty_rate +
                                 factor(year) + factor(month), data = df)),
    m4 = map(train, \(df) glm.nb(rat_count_zip_month ~ lag_violation_rate +
                                 population_density + poverty_rate +
                                 factor(year) + factor(month), data = df))
  )</code></pre>
<pre class="r"><code>rmse_nb &lt;- function(model, df) {
  pred &lt;- predict(model, newdata=df, type=&quot;response&quot;)
  sqrt(mean((df$rat_count_zip_month - pred)^2))
}

cv_df &lt;- cv_df |&gt;
  mutate(
    rmse_m1 = map2_dbl(m1, test, rmse_nb),
    rmse_m2 = map2_dbl(m2, test, rmse_nb),
    rmse_m3 = map2_dbl(m3, test, rmse_nb),
    rmse_m4 = map2_dbl(m4, test, rmse_nb),

    aic_m1 = map_dbl(m1, AIC),
    aic_m2 = map_dbl(m2, AIC),
    aic_m3 = map_dbl(m3, AIC),
    aic_m4 = map_dbl(m4, AIC)
  )</code></pre>
<p>Model 1 had the highest RMSE values, indicating poorer predictive
accuracy. Adding socioeconomic covariates (Model 2) reduced RMSE
substantially, while further adding time controls (Model 3) and lagged
exposure (Model 4) continued to improve prediction. From the RMSE plot,
Model 4 has the lowest and most concentrated RMSE distribution. This
indicates that incorporating a lagged violation rate improves prediction
accuracy and model stability.</p>
<p>It suggests that poor sanitation does not trigger rat activity
immediately but has a delayed and cumulative impact on infestation
risk.</p>
<pre class="r"><code>cv_df |&gt;
  dplyr::select(starts_with(&quot;rmse&quot;)) |&gt;
  tidyr::pivot_longer(everything(),
               names_to=&quot;model&quot;, values_to=&quot;rmse&quot;,
               names_prefix=&quot;rmse_&quot;) |&gt;
  mutate(model=factor(model, levels=c(&quot;m1&quot;,&quot;m2&quot;,&quot;m3&quot;,&quot;m4&quot;))) |&gt;
  ggplot(aes(x=model, y=rmse)) +
  geom_violin(fill=&quot;lightblue&quot;) +
  theme_minimal() +
  labs(
    x=&quot;Model&quot;,
    y=&quot;RMSE&quot;,
    title=&quot;Cross-Validation Performance: RMSE&quot;
  )</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-34-1.png" width="90%" /></p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>In this study, we integrated New York City rat sighting reports with
restaurant inspection results to investigate the potential association
between neighborhood-level restaurant sanitation and rat activity. Our
results indicate that monthly rat sightings exhibit a clear seasonal
pattern—peaking in warmer months—and show a sustained upward trend in
the post-pandemic period. In contrast, restaurant violation rates remain
relatively stable over time with smaller fluctuations. This suggests
that restaurant sanitation likely represents only one contributing risk
component.</p>
<p>Moreover, we observed that the spatial distributions of rat sightings
and restaurant violation rates only partially overlap. Some
neighborhoods experience high violation rates without the highest rat
activity, while others show substantial rat problems despite relatively
low violation rates. These findings suggest that rat infestations are
shaped by a more complex interplay of factors—such as population
density, poverty burden, aging housing stock, and urban
infrastructure—beyond restaurant sanitation alone. In addition, the
detection of clear hotspot clusters indicates potential spatial
spillover of environmental health risks across neighboring ZIP
codes.</p>
<p>Further modeling analyses revealed that the best model - lagged
(one-month) restaurant violation rate is a statistically significant
predictor of rat sightings. This supports a plausible mechanism: poorer
sanitation and improper waste handling in restaurants may create more
favorable food and habitat conditions for rats, leading to increased
activity and sightings in the following month. Additionally,
socioeconomic characteristics—such as neighborhood poverty levels and
population density—were also significantly associated with rat activity,
indicating underlying structural disparities across communities. These
findings highlight that rat problems are closely tied not only to local
sanitation management but also to broader dimensions of urban
infrastructure and public health equity.</p>
<p>The temporal and spatial disparities revealed in this study provide
important guidance for urban rodent control strategies. First, the sharp
seasonal rise in rat activity during summer suggests that the city
should reinforce waste management and inspection efforts in advance of
high-risk months, particularly within hotspot ZIP codes. Second, the
observed lagged association between restaurant violation rates and rat
sightings highlights the value of coordinated environmental health
governance—strengthening food sanitation enforcement and improving waste
handling practices may help reduce subsequent rodent exposure risks.
Furthermore, the socioeconomic patterns observed indicate that rat
burdens are disproportionately concentrated in resource-limited
communities, underscoring the need to incorporate health equity
considerations into municipal pest-control planning.</p>
</div>
<div id="limitations" class="section level2">
<h2>Limitations</h2>
<p>Despite these meaningful insights, several limitations should be
acknowledged. Rat sighting data rely on resident reporting, which may be
influenced by behavioral factors such as pandemic-related activity
changes or differential awareness across communities, introducing
potential reporting bias. In addition, considering of complexicity of
this study, violation rate reflects sanitation only at the restaurant
level and does not account for broader environmental determinants such
as street garbage systems, building age and maintenance, underground
infrastructure, or transit corridors, limiting the strength of causal
interpretations. Finally, while ZIP–Month aggregation facilitates
spatio-temporal modeling, it may mask finer-scale variation; future work
could leverage more granular geographic units to refine environmental
risk assessment.</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
